<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: Numo::Linalg
  
    &mdash; Documentation by YARD 0.9.12
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "Numo::Linalg";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../x_index.html">Index (L)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Numo.html" title="Numo (module)">Numo</a></span></span>
     &raquo; 
    <span class="title">Linalg</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: Numo::Linalg
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>ext/numo/linalg/blas/blas.c<span class="defines">,<br />
  ext/numo/linalg/blas/blas_c.c,<br /> ext/numo/linalg/blas/blas_d.c,<br /> ext/numo/linalg/blas/blas_s.c,<br /> ext/numo/linalg/blas/blas_z.c,<br /> ext/numo/linalg/lapack/lapack.c,<br /> ext/numo/linalg/lapack/lapack_c.c,<br /> ext/numo/linalg/lapack/lapack_d.c,<br /> ext/numo/linalg/lapack/lapack_s.c,<br /> ext/numo/linalg/lapack/lapack_z.c,<br /> lib/numo/linalg/autoloader.rb,<br /> lib/numo/linalg/function.rb,<br /> lib/numo/linalg/loader.rb,<br /> lib/numo/linalg/version.rb</span>
</dd>
  </dl>
  
</div>

<h2>Defined Under Namespace</h2>
<p class="children">
  
    
      <strong class="modules">Modules:</strong> <span class='object_link'><a href="Linalg/Autoloader.html" title="Numo::Linalg::Autoloader (module)">Autoloader</a></span>, <span class='object_link'><a href="Linalg/Blas.html" title="Numo::Linalg::Blas (module)">Blas</a></span>, <span class='object_link'><a href="Linalg/Lapack.html" title="Numo::Linalg::Lapack (module)">Lapack</a></span>, <span class='object_link'><a href="Linalg/Loader.html" title="Numo::Linalg::Loader (module)">Loader</a></span>
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="Linalg/LapackError.html" title="Numo::Linalg::LapackError (class)">LapackError</a></span>
    
  
</p>

  <h2>Constant Summary</h2>
  <dl class="constants">
    
      <dt id="BLAS_CHAR-constant" class="">BLAS_CHAR =
        
      </dt>
      <dd><pre class="code"><span class='lbrace'>{</span>
 <span class='const'>SFloat</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>s</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
 <span class='const'>DFloat</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>d</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
 <span class='const'>SComplex</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>c</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
 <span class='const'>DComplex</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>z</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
<span class='rbrace'>}</span></pre></dd>
    
      <dt id="VERSION-constant" class="">VERSION =
        
      </dt>
      <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>0.1.3</span><span class='tstring_end'>&quot;</span></span></pre></dd>
    
  </dl>







  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#blas_char-class_method" title="blas_char (class method)">.<strong>blas_char</strong>(*args)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#cho_fact-class_method" title="cho_fact (class method)">.<strong>cho_fact</strong>(a, uplo: &#39;U&#39;)  &#x21d2; Numo::NArray </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Computes the Cholesky factorization of a symmetric/Hermitian positive definite matrix A.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#cho_inv-class_method" title="cho_inv (class method)">.<strong>cho_inv</strong>(a, uplo: &#39;U&#39;)  &#x21d2; Numo::NArray </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Computes the inverse of a symmetric/Hermitian positive definite matrix A using the Cholesky factorization <code>A = U**T*U</code> or <code>A = L*L**T</code> computed by Linalg.cho_fact.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#cho_solve-class_method" title="cho_solve (class method)">.<strong>cho_solve</strong>(a, b, uplo: &#39;U&#39;)  &#x21d2; Numo::NArray </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Solves a system of linear equations     A*X = B with a symmetric/Hermitian positive definite matrix A using the Cholesky factorization <code>A = U**T*U</code> or <code>A = L*L**T</code> computed by Linalg.cho_fact.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#cholesky-class_method" title="cholesky (class method)">.<strong>cholesky</strong>(a, uplo: &#39;U&#39;)  &#x21d2; Numo::NArray </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Computes the Cholesky factorization of a symmetric/Hermitian positive definite matrix A.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#cond-class_method" title="cond (class method)">.<strong>cond</strong>(a, ord = nil)  &#x21d2; Numo::NArray </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Compute the condition number of a matrix using the norm with one of the following order.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#det-class_method" title="det (class method)">.<strong>det</strong>(a)  &#x21d2; Float or Complex or Numo::NArray </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Determinant of a matrix.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#dot-class_method" title="dot (class method)">.<strong>dot</strong>(a, b)  &#x21d2; Numo::NArray </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Dot product.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#eig-class_method" title="eig (class method)">.<strong>eig</strong>(a, left: false, right: true)  &#x21d2; [w,vl,vr] </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Computes the eigenvalues and, optionally, the left and/or right eigenvectors for a square nonsymmetric matrix A.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#eigh-class_method" title="eigh (class method)">.<strong>eigh</strong>(a, b = nil, vals_only: false, vals_range: nil, uplo: &#39;U&#39;, turbo: false)  &#x21d2; [w,v] </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Obtains the eigenvalues and, optionally, the eigenvectors by solving an ordinary or generalized eigenvalue problem for a square symmetric / Hermitian matrix.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#eigvals-class_method" title="eigvals (class method)">.<strong>eigvals</strong>(a)  &#x21d2; Numo::NArray </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Computes the eigenvalues only for a square nonsymmetric matrix A.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#eigvalsh-class_method" title="eigvalsh (class method)">.<strong>eigvalsh</strong>(a, b = nil, vals_range: nil, uplo: &#39;U&#39;, turbo: false)  &#x21d2; Numo::NArray </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Obtains the eigenvalues by solving an ordinary or generalized eigenvalue problem for a square symmetric / Hermitian matrix.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#inv-class_method" title="inv (class method)">.<strong>inv</strong>(a, driver: &quot;getrf&quot;, uplo: &#39;U&#39;)  &#x21d2; Numo::NArray </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Inverse matrix from square matrix <code>a</code>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#ldl-class_method" title="ldl (class method)">.<strong>ldl</strong>(a, uplo: &#39;U&#39;, hermitian: true)  &#x21d2; [lu,d,perm] </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Computes the LDLt or Bunch-Kaufman factorization of a symmetric/Hermitian matrix A.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#lstsq-class_method" title="lstsq (class method)">.<strong>lstsq</strong>(a, b, driver: &#39;lsd&#39;, rcond: -1))  &#x21d2; [x, resids, rank, s] </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Computes the minimum-norm solution to a linear least squares problem:.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#lu-class_method" title="lu (class method)">.<strong>lu</strong>(a, permute_l: false)  &#x21d2; [p,l,u], [pl,u] </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Computes an LU factorization of a M-by-N matrix A using partial pivoting with row interchanges.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#lu_fact-class_method" title="lu_fact (class method)">.<strong>lu_fact</strong>(a)  &#x21d2; [lu, ipiv] </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Computes an LU factorization of a M-by-N matrix A using partial pivoting with row interchanges.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#lu_inv-class_method" title="lu_inv (class method)">.<strong>lu_inv</strong>(lu, ipiv)  &#x21d2; Numo::NArray </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Computes the inverse of a matrix using the LU factorization computed by Numo::Linalg.lu_fact.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#lu_solve-class_method" title="lu_solve (class method)">.<strong>lu_solve</strong>(lu, ipiv, b, trans: &quot;N&quot;)  &#x21d2; Numo::NArray </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Solves a system of linear equations.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#matmul-class_method" title="matmul (class method)">.<strong>matmul</strong>(a, b)  &#x21d2; Numo::NArray </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Matrix product.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#matrix_power-class_method" title="matrix_power (class method)">.<strong>matrix_power</strong>(a, n)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Compute a square matrix <code>a</code> to the power <code>n</code>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#matrix_rank-class_method" title="matrix_rank (class method)">.<strong>matrix_rank</strong>(m, tol: nil, driver: &#39;svd&#39;)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Compute matrix rank of array using SVD <em>Rank</em> is the number of singular values greater than <em>tol</em>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#norm-class_method" title="norm (class method)">.<strong>norm</strong>(a, ord = nil, axis: nil, keepdims: false)  &#x21d2; Numo::NArray </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Compute matrix or vector norm.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#pinv-class_method" title="pinv (class method)">.<strong>pinv</strong>(a, driver: &quot;svd&quot;, rcond: nil)  &#x21d2; Numo::NArray </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Compute the (Moore-Penrose) pseudo-inverse of a matrix using svd or lstsq.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#qr-class_method" title="qr (class method)">.<strong>qr</strong>(a, mode: &quot;reduce&quot;)  &#x21d2; r, ... </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Computes a QR factorization of a complex M-by-N matrix A: A = Q * R.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#slogdet-class_method" title="slogdet (class method)">.<strong>slogdet</strong>(a)  &#x21d2; [sign,logdet] </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Natural logarithm of the determinant of a matrix.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#solve-class_method" title="solve (class method)">.<strong>solve</strong>(a, b, driver: &quot;gen&quot;, uplo: &#39;U&#39;)  &#x21d2; Numo::NArray </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Solves linear equation <code>a * x = b</code> for <code>x</code> from square matrix <code>a</code>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#svd-class_method" title="svd (class method)">.<strong>svd</strong>(a, driver: &#39;svd&#39;, job: &#39;A&#39;)  &#x21d2; [sigma,u,vt] </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Computes the Singular Value Decomposition (SVD) of a M-by-N matrix A, and the left and/or right singular vectors.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#svdvals-class_method" title="svdvals (class method)">.<strong>svdvals</strong>(a, driver: &#39;svd&#39;)  &#x21d2; Numo::NArray </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Computes the Singular Values of a M-by-N matrix A.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="blas_char-class_method">
  
    .<strong>blas_char</strong>(*args)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/numo/linalg/function.rb', line 57</span>

<span class='kw'>def</span> <span class='id identifier rubyid_blas_char'>blas_char</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_t'>t</span> <span class='op'>=</span> <span class='const'>Float</span>
  <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='op'>|</span>
    <span class='id identifier rubyid_k'>k</span> <span class='op'>=</span>
      <span class='kw'>case</span> <span class='id identifier rubyid_a'>a</span>
      <span class='kw'>when</span> <span class='const'>NArray</span>
        <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span>
      <span class='kw'>when</span> <span class='const'>Array</span>
        <span class='const'>NArray</span><span class='period'>.</span><span class='id identifier rubyid_array_type'>array_type</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_k'>k</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_k'>k</span> <span class='op'>&lt;</span> <span class='const'>NArray</span>
      <span class='id identifier rubyid_t'>t</span> <span class='op'>=</span> <span class='id identifier rubyid_k'>k</span><span class='op'>::</span><span class='const'>UPCAST</span><span class='lbracket'>[</span><span class='id identifier rubyid_t'>t</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='id identifier rubyid_t'>t</span><span class='op'>::</span><span class='const'>UPCAST</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='const'><span class='object_link'><a href="#BLAS_CHAR-constant" title="Numo::Linalg::BLAS_CHAR (constant)">BLAS_CHAR</a></span></span><span class='lbracket'>[</span><span class='id identifier rubyid_t'>t</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='id identifier rubyid_raise'>raise</span><span class='lparen'>(</span><span class='const'>TypeError</span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>invalid data type for BLAS/LAPACK</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="cho_fact-class_method">
  
    .<strong>cho_fact</strong>(a, uplo: &#39;U&#39;)  &#x21d2; <tt>Numo::NArray</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Computes the Cholesky factorization of a symmetric/Hermitian
positive definite matrix A. The factorization has the form</p>

<pre class="code ruby"><code class="ruby">A = U**H * U,  if UPLO = &#39;U&#39;, or
A = L  * L**H,  if UPLO = &#39;L&#39;,
</code></pre>

<p>where U is an upper triangular matrix and L is a lower triangular matrix.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>a</span>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>n-by-n symmetric matrix A (&gt;= 2-dimensinal NArray)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>uplo</span>
      
      
        <span class='type'>(<tt>String or Symbol</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>optional, default=’U’. Access upper
or (‘U’) lower (‘L’) triangle.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The matrix which has the Cholesky factor in upper or lower triangular part.
Remain part consists of random values.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


497
498
499</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/numo/linalg/function.rb', line 497</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cho_fact'>cho_fact</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='label'>uplo:</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>U</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='const'><span class='object_link'><a href="Linalg/Lapack.html" title="Numo::Linalg::Lapack (module)">Lapack</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Lapack.html#call-class_method" title="Numo::Linalg::Lapack.call (method)">call</a></span></span><span class='lparen'>(</span><span class='symbol'>:potrf</span><span class='comma'>,</span> <span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='label'>uplo:</span><span class='id identifier rubyid_uplo'>uplo</span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="cho_inv-class_method">
  
    .<strong>cho_inv</strong>(a, uplo: &#39;U&#39;)  &#x21d2; <tt>Numo::NArray</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Computes the inverse of a symmetric/Hermitian
positive definite matrix A using the Cholesky factorization
<code>A = U**T*U</code> or <code>A = L*L**T</code> computed by Linalg.cho_fact.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>a</span>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the triangular factor U or L from the
Cholesky factorization, as computed by Linalg.cho_fact.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>uplo</span>
      
      
        <span class='type'>(<tt>String or Symbol</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>optional, default=’U’. Access upper
or (‘U’) lower (‘L’) triangle.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the upper or lower triangle of the
(symmetric) inverse of A.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


512
513
514</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/numo/linalg/function.rb', line 512</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cho_inv'>cho_inv</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='label'>uplo:</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>U</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='const'><span class='object_link'><a href="Linalg/Lapack.html" title="Numo::Linalg::Lapack (module)">Lapack</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Lapack.html#call-class_method" title="Numo::Linalg::Lapack.call (method)">call</a></span></span><span class='lparen'>(</span><span class='symbol'>:potri</span><span class='comma'>,</span> <span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='label'>uplo:</span><span class='id identifier rubyid_uplo'>uplo</span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="cho_solve-class_method">
  
    .<strong>cho_solve</strong>(a, b, uplo: &#39;U&#39;)  &#x21d2; <tt>Numo::NArray</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Solves a system of linear equations
    A*X = B
with a symmetric/Hermitian positive definite matrix A
using the Cholesky factorization
<code>A = U**T*U</code> or <code>A = L*L**T</code> computed by Linalg.cho_fact.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>a</span>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the triangular factor U or L from the
Cholesky factorization, as computed by Linalg.cho_fact.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>b</span>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the right hand side matrix B.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>uplo</span>
      
      
        <span class='type'>(<tt>String or Symbol</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>optional, default=’U’. Access upper
or (‘U’) lower (‘L’) triangle.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the solution matrix X.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


528
529
530</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/numo/linalg/function.rb', line 528</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cho_solve'>cho_solve</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='comma'>,</span> <span class='label'>uplo:</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>U</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='const'><span class='object_link'><a href="Linalg/Lapack.html" title="Numo::Linalg::Lapack (module)">Lapack</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Lapack.html#call-class_method" title="Numo::Linalg::Lapack.call (method)">call</a></span></span><span class='lparen'>(</span><span class='symbol'>:potrs</span><span class='comma'>,</span> <span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='comma'>,</span> <span class='label'>uplo:</span><span class='id identifier rubyid_uplo'>uplo</span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="cholesky-class_method">
  
    .<strong>cholesky</strong>(a, uplo: &#39;U&#39;)  &#x21d2; <tt>Numo::NArray</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Computes the Cholesky factorization of a symmetric/Hermitian
positive definite matrix A. The factorization has the form</p>

<pre class="code ruby"><code class="ruby">A = U**H * U,  if UPLO = &#39;U&#39;, or
A = L  * L**H,  if UPLO = &#39;L&#39;,
</code></pre>

<p>where U is an upper triangular matrix and L is a lower triangular matrix.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>a</span>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>n-by-n symmetric matrix A (&gt;= 2-dimensinal NArray)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>uplo</span>
      
      
        <span class='type'>(<tt>String or Symbol</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>optional, default=’U’. Access upper
or (‘U’) lower (‘L’) triangle.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The factor U or L.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>NArray::ShapeError</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


470
471
472
473
474
475
476
477
478
479
480
481
482</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/numo/linalg/function.rb', line 470</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cholesky'>cholesky</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='label'>uplo:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>U</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>NArray</span><span class='op'>::</span><span class='const'>ShapeError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>2-d array is required</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_ndim'>ndim</span> <span class='op'>&lt;</span> <span class='int'>2</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>NArray</span><span class='op'>::</span><span class='const'>ShapeError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>matrix a is not square matrix</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span> <span class='op'>!=</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_factor'>factor</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Linalg/Lapack.html" title="Numo::Linalg::Lapack (module)">Lapack</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Lapack.html#call-class_method" title="Numo::Linalg::Lapack.call (method)">call</a></span></span><span class='lparen'>(</span><span class='symbol'>:potrf</span><span class='comma'>,</span> <span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='label'>uplo:</span> <span class='id identifier rubyid_uplo'>uplo</span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_uplo'>uplo</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>U</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_factor'>factor</span><span class='period'>.</span><span class='id identifier rubyid_triu'>triu</span>
  <span class='kw'>else</span>
    <span class='comment'># TODO: Use the tril method if the verision of Numo::NArray
</span>    <span class='comment'>#       in the runtime dependency list becomes 0.9.1.3 or higher.
</span>    <span class='id identifier rubyid_m'>m</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span>
    <span class='id identifier rubyid_factor'>factor</span> <span class='op'>*</span> <span class='const'><span class='object_link'><a href="../Numo.html" title="Numo (module)">Numo</a></span></span><span class='op'>::</span><span class='const'>DFloat</span><span class='period'>.</span><span class='id identifier rubyid_ones'>ones</span><span class='lparen'>(</span><span class='id identifier rubyid_m'>m</span><span class='comma'>,</span> <span class='id identifier rubyid_m'>m</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_triu'>triu</span><span class='period'>.</span><span class='id identifier rubyid_transpose'>transpose</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="cond-class_method">
  
    .<strong>cond</strong>(a, ord = nil)  &#x21d2; <tt>Numo::NArray</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Compute the condition number of a matrix
using the norm with one of the following order.</p>

<pre class="code ruby"><code class="ruby">|  ord  |  matrix norm           |
| ----- | ---------------------- |
|  nil  | 2-norm using SVD       |
| &#39;fro&#39; | Frobenius norm         |
| &#39;inf&#39; | x.abs.sum(axis:-1).max |
|    1  | x.abs.sum(axis:-2).max |
|    2  | 2-norm (max sing_vals) |
</code></pre>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code>a = Numo::DFloat[[1, 0, -1], [0, 1, 0], [1, 0, 1]]
=&gt; Numo::DFloat#shape=[3,3]
[[1, 0, -1],
 [0, 1, 0],
 [1, 0, 1]]
LA = Numo::Linalg
LA.cond(a)
=&gt; 1.4142135623730951
LA.cond(a, &#39;fro&#39;)
=&gt; 3.1622776601683795
LA.cond(a, &#39;inf&#39;)
=&gt; 2.0
LA.cond(a, &#39;-inf&#39;)
=&gt; 1.0
LA.cond(a, 1)
=&gt; 2.0
LA.cond(a, -1)
=&gt; 1.0
LA.cond(a, 2)
=&gt; 1.4142135623730951
LA.cond(a, -2)
=&gt; 0.7071067811865475
(LA.svdvals(a)).min*(LA.svdvals(LA.inv(a))).min
=&gt; 0.7071067811865475</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>a</span>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>matrix or vector (&gt;= 1-dimensinal NArray)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>ord</span>
      
      
        <span class='type'>(<tt>String or Symbol</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Order of the norm.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>cond result</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


802
803
804
805
806
807
808
809</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/numo/linalg/function.rb', line 802</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cond'>cond</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span><span class='id identifier rubyid_ord'>ord</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_ord'>ord</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='id identifier rubyid_svdvals'>svdvals</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_s'>s</span><span class='lbracket'>[</span><span class='kw'>false</span><span class='comma'>,</span> <span class='int'>0</span><span class='rbracket'>]</span><span class='op'>/</span><span class='id identifier rubyid_s'>s</span><span class='lbracket'>[</span><span class='kw'>false</span><span class='comma'>,</span> <span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_norm'>norm</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_ord'>ord</span><span class='comma'>,</span> <span class='label'>axis:</span><span class='lbracket'>[</span><span class='op'>-</span><span class='int'>2</span><span class='comma'>,</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='op'>*</span> <span class='id identifier rubyid_norm'>norm</span><span class='lparen'>(</span><span class='id identifier rubyid_inv'>inv</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_ord'>ord</span><span class='comma'>,</span> <span class='label'>axis:</span><span class='lbracket'>[</span><span class='op'>-</span><span class='int'>2</span><span class='comma'>,</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="det-class_method">
  
    .<strong>det</strong>(a)  &#x21d2; <tt>Float or Complex or Numo::NArray</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Determinant of a matrix</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>a</span>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>matrix (&gt;= 2-dimensional NArray)</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Float or Complex or Numo::NArray</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


816
817
818
819
820
821
822</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/numo/linalg/function.rb', line 816</span>

<span class='kw'>def</span> <span class='id identifier rubyid_det'>det</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_lu'>lu</span><span class='comma'>,</span> <span class='id identifier rubyid_piv'>piv</span><span class='comma'>,</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Linalg/Lapack.html" title="Numo::Linalg::Lapack (module)">Lapack</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Lapack.html#call-class_method" title="Numo::Linalg::Lapack.call (method)">call</a></span></span><span class='lparen'>(</span><span class='symbol'>:getrf</span><span class='comma'>,</span> <span class='id identifier rubyid_a'>a</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_idx'>idx</span> <span class='op'>=</span> <span class='id identifier rubyid_piv'>piv</span><span class='period'>.</span><span class='id identifier rubyid_new_narray'>new_narray</span><span class='period'>.</span><span class='id identifier rubyid_store'>store</span><span class='lparen'>(</span><span class='id identifier rubyid_piv'>piv</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_piv'>piv</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='lbracket'>[</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_seq'>seq</span><span class='lparen'>(</span><span class='int'>1</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_m'>m</span> <span class='op'>=</span> <span class='id identifier rubyid_piv'>piv</span><span class='period'>.</span><span class='id identifier rubyid_eq'>eq</span><span class='lparen'>(</span><span class='id identifier rubyid_idx'>idx</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_count_false'>count_false</span><span class='lparen'>(</span><span class='label'>axis:</span><span class='op'>-</span><span class='int'>1</span><span class='rparen'>)</span> <span class='op'>%</span> <span class='int'>2</span>
  <span class='id identifier rubyid_sign'>sign</span> <span class='op'>=</span> <span class='id identifier rubyid_m'>m</span> <span class='op'>*</span> <span class='op'>-</span><span class='int'>2</span> <span class='op'>+</span> <span class='int'>1</span>
  <span class='id identifier rubyid_lu'>lu</span><span class='period'>.</span><span class='id identifier rubyid_diagonal'>diagonal</span><span class='period'>.</span><span class='id identifier rubyid_prod'>prod</span><span class='lparen'>(</span><span class='label'>axis:</span><span class='op'>-</span><span class='int'>1</span><span class='rparen'>)</span> <span class='op'>*</span> <span class='id identifier rubyid_sign'>sign</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="dot-class_method">
  
    .<strong>dot</strong>(a, b)  &#x21d2; <tt>Numo::NArray</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Dot product.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>a</span>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>matrix or vector (&gt;= 1-dimensinal NArray)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>b</span>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>matrix or vector (&gt;= 1-dimensinal NArray)</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>result of dot product</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/numo/linalg/function.rb', line 82</span>

<span class='kw'>def</span> <span class='id identifier rubyid_dot'>dot</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='const'>NArray</span><span class='period'>.</span><span class='id identifier rubyid_asarray'>asarray</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_b'>b</span> <span class='op'>=</span> <span class='const'>NArray</span><span class='period'>.</span><span class='id identifier rubyid_asarray'>asarray</span><span class='lparen'>(</span><span class='id identifier rubyid_b'>b</span><span class='rparen'>)</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_ndim'>ndim</span>
  <span class='kw'>when</span> <span class='int'>1</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_b'>b</span><span class='period'>.</span><span class='id identifier rubyid_ndim'>ndim</span>
    <span class='kw'>when</span> <span class='int'>1</span>
      <span class='id identifier rubyid_func'>func</span> <span class='op'>=</span> <span class='id identifier rubyid_blas_char'>blas_char</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='rparen'>)</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>c|z</span><span class='regexp_end'>/</span></span> <span class='op'>?</span> <span class='symbol'>:dotu</span> <span class='op'>:</span> <span class='symbol'>:dot</span>
      <span class='const'><span class='object_link'><a href="Linalg/Blas.html" title="Numo::Linalg::Blas (module)">Blas</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Blas.html#call-class_method" title="Numo::Linalg::Blas.call (method)">call</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_func'>func</span><span class='comma'>,</span> <span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='const'><span class='object_link'><a href="Linalg/Blas.html" title="Numo::Linalg::Blas (module)">Blas</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Blas.html#call-class_method" title="Numo::Linalg::Blas.call (method)">call</a></span></span><span class='lparen'>(</span><span class='symbol'>:gemv</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='comma'>,</span> <span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='label'>trans:</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>t</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_b'>b</span><span class='period'>.</span><span class='id identifier rubyid_ndim'>ndim</span>
    <span class='kw'>when</span> <span class='int'>1</span>
      <span class='const'><span class='object_link'><a href="Linalg/Blas.html" title="Numo::Linalg::Blas (module)">Blas</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Blas.html#call-class_method" title="Numo::Linalg::Blas.call (method)">call</a></span></span><span class='lparen'>(</span><span class='symbol'>:gemv</span><span class='comma'>,</span> <span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='const'><span class='object_link'><a href="Linalg/Blas.html" title="Numo::Linalg::Blas (module)">Blas</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Blas.html#call-class_method" title="Numo::Linalg::Blas.call (method)">call</a></span></span><span class='lparen'>(</span><span class='symbol'>:gemm</span><span class='comma'>,</span> <span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="eig-class_method">
  
    .<strong>eig</strong>(a, left: false, right: true)  &#x21d2; <tt>[w,vl,vr]</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Computes the eigenvalues and, optionally, the left and/or right
eigenvectors for a square nonsymmetric matrix A.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>a</span>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>square nonsymmetric matrix (&gt;= 2-dimensinal NArray)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>left</span>
      
      
        <span class='type'>(<tt>Bool</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>(optional) If true, left eigenvectors are computed.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>right</span>
      
      
        <span class='type'>(<tt>Bool</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>(optional) If true, right eigenvectors are computed.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>[w,vl,vr]</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><ul>
  <li><strong>w</strong>  [Numo::NArray] – The eigenvalues.</li>
  <li><strong>vl</strong> [Numo::NArray] – The left eigenvectors if left is true, otherwise nil.</li>
  <li><strong>vr</strong> [Numo::NArray] – The right eigenvectors if right is true, otherwise nil.</li>
</ul>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


546
547
548
549
550
551
552
553
554
555
556
557
558</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/numo/linalg/function.rb', line 546</span>

<span class='kw'>def</span> <span class='id identifier rubyid_eig'>eig</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='label'>left:</span><span class='kw'>false</span><span class='comma'>,</span> <span class='label'>right:</span><span class='kw'>true</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_jobvl'>jobvl</span><span class='comma'>,</span> <span class='id identifier rubyid_jobvr'>jobvr</span> <span class='op'>=</span> <span class='id identifier rubyid_left'>left</span><span class='comma'>,</span> <span class='id identifier rubyid_right'>right</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_blas_char'>blas_char</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='rparen'>)</span>
  <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>c|z</span><span class='regexp_end'>/</span></span>
    <span class='id identifier rubyid_w'>w</span><span class='comma'>,</span> <span class='id identifier rubyid_vl'>vl</span><span class='comma'>,</span> <span class='id identifier rubyid_vr'>vr</span><span class='comma'>,</span> <span class='id identifier rubyid_info'>info</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Linalg/Lapack.html" title="Numo::Linalg::Lapack (module)">Lapack</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Lapack.html#call-class_method" title="Numo::Linalg::Lapack.call (method)">call</a></span></span><span class='lparen'>(</span><span class='symbol'>:geev</span><span class='comma'>,</span> <span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='label'>jobvl:</span><span class='id identifier rubyid_jobvl'>jobvl</span><span class='comma'>,</span> <span class='label'>jobvr:</span><span class='id identifier rubyid_jobvr'>jobvr</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_wr'>wr</span><span class='comma'>,</span> <span class='id identifier rubyid_wi'>wi</span><span class='comma'>,</span> <span class='id identifier rubyid_vl'>vl</span><span class='comma'>,</span> <span class='id identifier rubyid_vr'>vr</span><span class='comma'>,</span> <span class='id identifier rubyid_info'>info</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Linalg/Lapack.html" title="Numo::Linalg::Lapack (module)">Lapack</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Lapack.html#call-class_method" title="Numo::Linalg::Lapack.call (method)">call</a></span></span><span class='lparen'>(</span><span class='symbol'>:geev</span><span class='comma'>,</span> <span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='label'>jobvl:</span><span class='id identifier rubyid_jobvl'>jobvl</span><span class='comma'>,</span> <span class='label'>jobvr:</span><span class='id identifier rubyid_jobvr'>jobvr</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_w'>w</span>  <span class='op'>=</span> <span class='id identifier rubyid_wr'>wr</span> <span class='op'>+</span> <span class='id identifier rubyid_wi'>wi</span> <span class='op'>*</span> <span class='const'>Complex</span><span class='op'>::</span><span class='const'>I</span>
    <span class='id identifier rubyid_vl'>vl</span> <span class='op'>=</span> <span class='id identifier rubyid__make_complex_eigvecs'>_make_complex_eigvecs</span><span class='lparen'>(</span><span class='id identifier rubyid_w'>w</span><span class='comma'>,</span><span class='id identifier rubyid_vl'>vl</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_left'>left</span>
    <span class='id identifier rubyid_vr'>vr</span> <span class='op'>=</span> <span class='id identifier rubyid__make_complex_eigvecs'>_make_complex_eigvecs</span><span class='lparen'>(</span><span class='id identifier rubyid_w'>w</span><span class='comma'>,</span><span class='id identifier rubyid_vr'>vr</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_right'>right</span>
  <span class='kw'>end</span>
  <span class='lbracket'>[</span><span class='id identifier rubyid_w'>w</span><span class='comma'>,</span><span class='id identifier rubyid_vl'>vl</span><span class='comma'>,</span><span class='id identifier rubyid_vr'>vr</span><span class='rbracket'>]</span> <span class='comment'>#.compact
</span><span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="eigh-class_method">
  
    .<strong>eigh</strong>(a, b = nil, vals_only: false, vals_range: nil, uplo: &#39;U&#39;, turbo: false)  &#x21d2; <tt>[w,v]</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Obtains the eigenvalues and, optionally, the eigenvectors
by solving an ordinary or generalized eigenvalue problem
for a square symmetric / Hermitian matrix.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>a</span>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>square symmetric matrix (&gt;= 2-dimensinal NArray)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>b</span>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>(optional) square symmetric matrix (&gt;= 2-dimensinal NArray)
If nil, identity matrix is assumed.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>vals_only</span>
      
      
        <span class='type'>(<tt>Bool</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>(optional) If false, eigenvectors are computed.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>vals_range</span>
      
      
        <span class='type'>(<tt>Range</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>(optional)
The range of indices of the eigenvalues (in ascending order) and corresponding eigenvectors to be returned.
If nil or 0…N (N is the size of the matrix a), all eigenvalues and eigenvectors are returned.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>uplo</span>
      
      
        <span class='type'>(<tt>String or Symbol</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>(optional, default=’U’)
Access upper (‘U’) or lower (‘L’) triangle.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>turbo</span>
      
      
        <span class='type'>(<tt>Bool</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>(optional) If true, divide and conquer algorithm is used.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>[w,v]</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><ul>
  <li><strong>w</strong> [Numo::NArray] – The eigenvalues.</li>
  <li><strong>v</strong> [Numo::NArray] – The eigenvectors if vals_only is false, otherwise nil.</li>
</ul>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


578
579
580
581
582
583
584
585
586
587
588
589
590
591
592
593
594
595</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/numo/linalg/function.rb', line 578</span>

<span class='kw'>def</span> <span class='id identifier rubyid_eigh'>eigh</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>vals_only:</span><span class='kw'>false</span><span class='comma'>,</span> <span class='label'>vals_range:</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>uplo:</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>U</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>turbo:</span><span class='kw'>false</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_jobz'>jobz</span> <span class='op'>=</span> <span class='id identifier rubyid_vals_only'>vals_only</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>N</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>V</span><span class='tstring_end'>&#39;</span></span> <span class='comment'># jobz: Compute eigenvalues and eigenvectors.
</span>  <span class='id identifier rubyid_b'>b</span> <span class='op'>=</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_eye'>eye</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_b'>b</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='id identifier rubyid_func'>func</span> <span class='op'>=</span> <span class='id identifier rubyid_blas_char'>blas_char</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='rparen'>)</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>c|z</span><span class='regexp_end'>/</span></span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hegv</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sygv</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>if</span> <span class='id identifier rubyid_vals_range'>vals_range</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='id identifier rubyid_func'>func</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>d</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_turbo'>turbo</span>
    <span class='id identifier rubyid_v'>v</span><span class='comma'>,</span> <span class='id identifier rubyid_u_'>u_</span><span class='comma'>,</span> <span class='id identifier rubyid_w'>w</span><span class='comma'>,</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Linalg/Lapack.html" title="Numo::Linalg::Lapack (module)">Lapack</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Lapack.html#call-class_method" title="Numo::Linalg::Lapack.call (method)">call</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_func'>func</span><span class='period'>.</span><span class='id identifier rubyid_to_sym'>to_sym</span><span class='comma'>,</span> <span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='comma'>,</span> <span class='label'>uplo:</span> <span class='id identifier rubyid_uplo'>uplo</span><span class='comma'>,</span> <span class='label'>jobz:</span> <span class='id identifier rubyid_jobz'>jobz</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_v'>v</span> <span class='op'>=</span> <span class='kw'>nil</span> <span class='kw'>if</span> <span class='id identifier rubyid_vals_only'>vals_only</span>
    <span class='lbracket'>[</span><span class='id identifier rubyid_w'>w</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='rbracket'>]</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_func'>func</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>x</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_il'>il</span> <span class='op'>=</span> <span class='id identifier rubyid_vals_range'>vals_range</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='lparen'>(</span><span class='int'>1</span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_iu'>iu</span> <span class='op'>=</span> <span class='id identifier rubyid_vals_range'>vals_range</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span><span class='lparen'>(</span><span class='int'>1</span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_a_'>a_</span><span class='comma'>,</span> <span class='id identifier rubyid_b_'>b_</span><span class='comma'>,</span> <span class='id identifier rubyid_w'>w</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='comma'>,</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Linalg/Lapack.html" title="Numo::Linalg::Lapack (module)">Lapack</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Lapack.html#call-class_method" title="Numo::Linalg::Lapack.call (method)">call</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_func'>func</span><span class='period'>.</span><span class='id identifier rubyid_to_sym'>to_sym</span><span class='comma'>,</span> <span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='comma'>,</span> <span class='label'>uplo:</span> <span class='id identifier rubyid_uplo'>uplo</span><span class='comma'>,</span> <span class='label'>jobz:</span> <span class='id identifier rubyid_jobz'>jobz</span><span class='comma'>,</span> <span class='label'>range:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>I</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>il:</span> <span class='id identifier rubyid_il'>il</span> <span class='op'>+</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>iu:</span> <span class='id identifier rubyid_iu'>iu</span> <span class='op'>+</span> <span class='int'>1</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_v'>v</span> <span class='op'>=</span> <span class='kw'>nil</span> <span class='kw'>if</span> <span class='id identifier rubyid_vals_only'>vals_only</span>
    <span class='lbracket'>[</span><span class='id identifier rubyid_w'>w</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="eigvals-class_method">
  
    .<strong>eigvals</strong>(a)  &#x21d2; <tt>Numo::NArray</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Computes the eigenvalues only for a square nonsymmetric matrix A.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>a</span>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>square nonsymmetric matrix (&gt;= 2-dimensinal NArray)</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>eigenvalues</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


602
603
604
605
606
607
608
609
610
611
612</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/numo/linalg/function.rb', line 602</span>

<span class='kw'>def</span> <span class='id identifier rubyid_eigvals'>eigvals</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_jobvl'>jobvl</span><span class='comma'>,</span> <span class='id identifier rubyid_jobvr'>jobvr</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>N</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>N</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>case</span> <span class='id identifier rubyid_blas_char'>blas_char</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='rparen'>)</span>
  <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>c|z</span><span class='regexp_end'>/</span></span>
    <span class='id identifier rubyid_w'>w</span><span class='comma'>,</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Linalg/Lapack.html" title="Numo::Linalg::Lapack (module)">Lapack</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Lapack.html#call-class_method" title="Numo::Linalg::Lapack.call (method)">call</a></span></span><span class='lparen'>(</span><span class='symbol'>:geev</span><span class='comma'>,</span> <span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='label'>jobvl:</span><span class='id identifier rubyid_jobvl'>jobvl</span><span class='comma'>,</span> <span class='label'>jobvr:</span><span class='id identifier rubyid_jobvr'>jobvr</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_wr'>wr</span><span class='comma'>,</span> <span class='id identifier rubyid_wi'>wi</span><span class='comma'>,</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Linalg/Lapack.html" title="Numo::Linalg::Lapack (module)">Lapack</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Lapack.html#call-class_method" title="Numo::Linalg::Lapack.call (method)">call</a></span></span><span class='lparen'>(</span><span class='symbol'>:geev</span><span class='comma'>,</span> <span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='label'>jobvl:</span><span class='id identifier rubyid_jobvl'>jobvl</span><span class='comma'>,</span> <span class='label'>jobvr:</span><span class='id identifier rubyid_jobvr'>jobvr</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_w'>w</span>  <span class='op'>=</span> <span class='id identifier rubyid_wr'>wr</span> <span class='op'>+</span> <span class='id identifier rubyid_wi'>wi</span> <span class='op'>*</span> <span class='const'>Complex</span><span class='op'>::</span><span class='const'>I</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_w'>w</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="eigvalsh-class_method">
  
    .<strong>eigvalsh</strong>(a, b = nil, vals_range: nil, uplo: &#39;U&#39;, turbo: false)  &#x21d2; <tt>Numo::NArray</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Obtains the eigenvalues by solving an ordinary or generalized eigenvalue problem
for a square symmetric / Hermitian matrix.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>a</span>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>square symmetric/hermitian matrix
(&gt;= 2-dimensinal NArray)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>b</span>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>(optional) square symmetric matrix (&gt;= 2-dimensinal NArray)
If nil, identity matrix is assumed.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>vals_range</span>
      
      
        <span class='type'>(<tt>Range</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>(optional)
The range of indices of the eigenvalues (in ascending order) to be returned.
If nil or 0…N (N is the size of the matrix a), all eigenvalues are returned.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>uplo</span>
      
      
        <span class='type'>(<tt>String or Symbol</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>(optional, default=’U’)
Access upper (‘U’) or lower (‘L’) triangle.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>eigenvalues</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


628
629
630</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/numo/linalg/function.rb', line 628</span>

<span class='kw'>def</span> <span class='id identifier rubyid_eigvalsh'>eigvalsh</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>vals_range:</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>uplo:</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>U</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>turbo:</span><span class='kw'>false</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_eigh'>eigh</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='comma'>,</span> <span class='label'>vals_only:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>vals_range:</span> <span class='id identifier rubyid_vals_range'>vals_range</span><span class='comma'>,</span> <span class='label'>uplo:</span> <span class='id identifier rubyid_uplo'>uplo</span><span class='comma'>,</span> <span class='label'>turbo:</span> <span class='id identifier rubyid_turbo'>turbo</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="inv-class_method">
  
    .<strong>inv</strong>(a, driver: &quot;getrf&quot;, uplo: &#39;U&#39;)  &#x21d2; <tt>Numo::NArray</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Inverse matrix from square matrix <code>a</code></p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code>Numo::Linalg.inv(a,driver:&#39;getrf&#39;)
=&gt; Numo::DFloat#shape=[2,2]
[[-2, 1],
 [1.5, -0.5]]
a.dot(Numo::Linalg.inv(a,driver:&#39;getrf&#39;))
=&gt; Numo::DFloat#shape=[2,2]
[[1, 0],
 [8.88178e-16, 1]]</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>a</span>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>n-by-n square matrix  (&gt;= 2-dimensinal NArray)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>driver</span>
      
      
        <span class='type'>(<tt>String or Symbol</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>choose LAPACK diriver
(‘ge’|’sy’|’he’|’po’) + (“sv”|”trf”)
(optional, default=’getrf’)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>uplo</span>
      
      
        <span class='type'>(<tt>String or Symbol</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>optional, default=’U’. Access upper
or (‘U’) lower (‘L’) triangle. (omitted when driver:”ge”)</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The inverse matrix.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


920
921
922
923
924
925
926
927
928
929
930
931
932
933
934
935
936</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/numo/linalg/function.rb', line 920</span>

<span class='kw'>def</span> <span class='id identifier rubyid_inv'>inv</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='label'>driver:</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>getrf</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>uplo:</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>U</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_driver'>driver</span>
  <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(ge|sy|he|po)sv$</span><span class='regexp_end'>/</span></span>
    <span class='id identifier rubyid_d'>d</span> <span class='op'>=</span> <span class='backref'>$1</span>
    <span class='id identifier rubyid_b'>b</span> <span class='op'>=</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_new_zeros'>new_zeros</span><span class='period'>.</span><span class='id identifier rubyid_eye'>eye</span>
    <span class='id identifier rubyid_solve'>solve</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='comma'>,</span> <span class='label'>driver:</span><span class='id identifier rubyid_d'>d</span><span class='comma'>,</span> <span class='label'>uplo:</span><span class='id identifier rubyid_uplo'>uplo</span><span class='rparen'>)</span>
  <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(ge|sy|he)tr[fi]$</span><span class='regexp_end'>/</span></span>
    <span class='id identifier rubyid_d'>d</span> <span class='op'>=</span> <span class='backref'>$1</span>
    <span class='id identifier rubyid_lu'>lu</span><span class='comma'>,</span> <span class='id identifier rubyid_piv'>piv</span> <span class='op'>=</span> <span class='id identifier rubyid_lu_fact'>lu_fact</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_lu_inv'>lu_inv</span><span class='lparen'>(</span><span class='id identifier rubyid_lu'>lu</span><span class='comma'>,</span> <span class='id identifier rubyid_piv'>piv</span><span class='rparen'>)</span>
  <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>potr[fi]$</span><span class='regexp_end'>/</span></span>
    <span class='id identifier rubyid_lu'>lu</span> <span class='op'>=</span> <span class='id identifier rubyid_cho_fact'>cho_fact</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='label'>uplo:</span><span class='id identifier rubyid_uplo'>uplo</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_cho_inv'>cho_inv</span><span class='lparen'>(</span><span class='id identifier rubyid_lu'>lu</span><span class='comma'>,</span> <span class='label'>uplo:</span><span class='id identifier rubyid_uplo'>uplo</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>invalid driver: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_driver'>driver</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="ldl-class_method">
  
    .<strong>ldl</strong>(a, uplo: &#39;U&#39;, hermitian: true)  &#x21d2; <tt>[<span class='object_link'><a href="#lu-class_method" title="Numo::Linalg.lu (method)">lu</a></span>,d,perm]</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Computes the LDLt or Bunch-Kaufman factorization of a symmetric/Hermitian matrix A.
The factorization has the form</p>

<pre class="code ruby"><code class="ruby"><span class='const'>A</span> <span class='op'>=</span> <span class='const'>U</span><span class='op'>*</span><span class='const'>D</span><span class='op'>*</span><span class='const'>U</span><span class='op'>**</span><span class='const'>T</span>  <span class='kw'>or</span>  <span class='const'>A</span> <span class='op'>=</span> <span class='const'>L</span><span class='op'>*</span><span class='const'>D</span><span class='op'>*</span><span class='const'>L</span><span class='op'>**</span><span class='const'>T</span>
</code></pre>

<p>where U (or L) is a product of permutation and unit upper (lower) triangular matrices
and D is symmetric and block diagonal with 1-by-1 and 2-by-2 diagonal blocks.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>a</span>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>m-by-m matrix A (&gt;= 2-dimensinal NArray)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>uplo</span>
      
      
        <span class='type'>(<tt>String or Symbol</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>optional, default=’U’. Access upper or (‘U’) lower (‘L’) triangle.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>hermitian</span>
      
      
        <span class='type'>(<tt>Bool</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>optional, default=true. If true, hermitian matrix is assumed.
(omitted when real-value matrix is given)</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>[<span class='object_link'><a href="#lu-class_method" title="Numo::Linalg.lu (method)">lu</a></span>,d,perm]</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><ul>
  <li><strong>lu</strong> [Numo::NArray] – The permutated upper (lower) triangular matrix U (L).</li>
  <li><strong>d</strong> [Numo::NArray] – The block diagonal matrix D.</li>
  <li><strong>perm</strong> [Numo::NArray] – The row-permutation index for changing lu into triangular form.</li>
</ul>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>NArray::ShapeError</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/numo/linalg/function.rb', line 419</span>

<span class='kw'>def</span> <span class='id identifier rubyid_ldl'>ldl</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='label'>uplo:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>U</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>hermitian:</span> <span class='kw'>true</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>NArray</span><span class='op'>::</span><span class='const'>ShapeError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>2-d array is required</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_ndim'>ndim</span> <span class='op'>&lt;</span> <span class='int'>2</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>NArray</span><span class='op'>::</span><span class='const'>ShapeError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>matrix a is not square matrix</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span> <span class='op'>!=</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_is_complex'>is_complex</span> <span class='op'>=</span> <span class='id identifier rubyid_blas_char'>blas_char</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='rparen'>)</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>c|z</span><span class='regexp_end'>/</span></span>
  <span class='id identifier rubyid_func'>func</span> <span class='op'>=</span> <span class='id identifier rubyid_is_complex'>is_complex</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_hermitian'>hermitian</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hetrf</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sytrf</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_lud'>lud</span><span class='comma'>,</span> <span class='id identifier rubyid_ipiv'>ipiv</span><span class='comma'>,</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Linalg/Lapack.html" title="Numo::Linalg::Lapack (module)">Lapack</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Lapack.html#call-class_method" title="Numo::Linalg::Lapack.call (method)">call</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_func'>func</span><span class='period'>.</span><span class='id identifier rubyid_to_sym'>to_sym</span><span class='comma'>,</span> <span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='label'>uplo:</span> <span class='id identifier rubyid_uplo'>uplo</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_lu'>lu</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_uplo'>uplo</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>U</span><span class='tstring_end'>&#39;</span></span> <span class='op'>?</span> <span class='id identifier rubyid_lud'>lud</span><span class='period'>.</span><span class='id identifier rubyid_triu'>triu</span> <span class='op'>:</span> <span class='id identifier rubyid_lud'>lud</span><span class='period'>.</span><span class='id identifier rubyid_tril'>tril</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_tap'>tap</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_mat'>mat</span><span class='op'>|</span> <span class='id identifier rubyid_mat'>mat</span><span class='lbracket'>[</span><span class='id identifier rubyid_mat'>mat</span><span class='period'>.</span><span class='id identifier rubyid_diag_indices'>diag_indices</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='float'>1.0</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_d'>d</span> <span class='op'>=</span> <span class='id identifier rubyid_lud'>lud</span><span class='lbracket'>[</span><span class='id identifier rubyid_lud'>lud</span><span class='period'>.</span><span class='id identifier rubyid_diag_indices'>diag_indices</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_diag'>diag</span>

  <span class='id identifier rubyid_m'>m</span> <span class='op'>=</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_n'>n</span> <span class='op'>=</span> <span class='id identifier rubyid_m'>m</span> <span class='op'>-</span> <span class='int'>1</span>
  <span class='id identifier rubyid_changed_2x2'>changed_2x2</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='id identifier rubyid_perm'>perm</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Numo.html" title="Numo (module)">Numo</a></span></span><span class='op'>::</span><span class='const'>Int32</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_m'>m</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_seq'>seq</span>
  <span class='id identifier rubyid_m'>m</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_t'>t</span><span class='op'>|</span>
    <span class='id identifier rubyid_i'>i</span> <span class='op'>=</span> <span class='id identifier rubyid_uplo'>uplo</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>U</span><span class='tstring_end'>&#39;</span></span> <span class='op'>?</span> <span class='id identifier rubyid_t'>t</span> <span class='op'>:</span> <span class='id identifier rubyid_n'>n</span> <span class='op'>-</span> <span class='id identifier rubyid_t'>t</span>
    <span class='id identifier rubyid_j'>j</span> <span class='op'>=</span> <span class='id identifier rubyid_uplo'>uplo</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>U</span><span class='tstring_end'>&#39;</span></span> <span class='op'>?</span> <span class='id identifier rubyid_i'>i</span> <span class='op'>-</span> <span class='int'>1</span> <span class='op'>:</span> <span class='id identifier rubyid_i'>i</span> <span class='op'>+</span> <span class='int'>1</span><span class='semicolon'>;</span>
    <span class='id identifier rubyid_r'>r</span> <span class='op'>=</span> <span class='id identifier rubyid_uplo'>uplo</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>U</span><span class='tstring_end'>&#39;</span></span> <span class='op'>?</span> <span class='int'>0</span><span class='op'>..</span><span class='id identifier rubyid_i'>i</span> <span class='op'>:</span> <span class='id identifier rubyid_i'>i</span><span class='op'>..</span><span class='id identifier rubyid_n'>n</span><span class='semicolon'>;</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_ipiv'>ipiv</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span> <span class='op'>&gt;</span> <span class='int'>0</span>
      <span class='id identifier rubyid_k'>k</span> <span class='op'>=</span> <span class='id identifier rubyid_ipiv'>ipiv</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span> <span class='op'>-</span> <span class='int'>1</span>
      <span class='id identifier rubyid_lu'>lu</span><span class='lbracket'>[</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_r'>r</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_lu'>lu</span><span class='lbracket'>[</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='comma'>,</span> <span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_r'>r</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
      <span class='id identifier rubyid_perm'>perm</span><span class='lbracket'>[</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_perm'>perm</span><span class='lbracket'>[</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='comma'>,</span> <span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_j'>j</span><span class='period'>.</span><span class='id identifier rubyid_between?'>between?</span><span class='lparen'>(</span><span class='int'>0</span><span class='comma'>,</span> <span class='id identifier rubyid_n'>n</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_ipiv'>ipiv</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_ipiv'>ipiv</span><span class='lbracket'>[</span><span class='id identifier rubyid_j'>j</span><span class='rbracket'>]</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_changed_2x2'>changed_2x2</span>
      <span class='id identifier rubyid_k'>k</span> <span class='op'>=</span> <span class='id identifier rubyid_ipiv'>ipiv</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_abs'>abs</span> <span class='op'>-</span> <span class='int'>1</span>
      <span class='id identifier rubyid_d'>d</span><span class='lbracket'>[</span><span class='id identifier rubyid_j'>j</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_lud'>lud</span><span class='lbracket'>[</span><span class='id identifier rubyid_j'>j</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_d'>d</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='comma'>,</span> <span class='id identifier rubyid_j'>j</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_is_complex'>is_complex</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_hermitian'>hermitian</span> <span class='op'>?</span> <span class='id identifier rubyid_lud'>lud</span><span class='lbracket'>[</span><span class='id identifier rubyid_j'>j</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_conj'>conj</span> <span class='op'>:</span> <span class='id identifier rubyid_lud'>lud</span><span class='lbracket'>[</span><span class='id identifier rubyid_j'>j</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_lu'>lu</span><span class='lbracket'>[</span><span class='id identifier rubyid_j'>j</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='float'>0.0</span>
      <span class='id identifier rubyid_lu'>lu</span><span class='lbracket'>[</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_j'>j</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_r'>r</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_lu'>lu</span><span class='lbracket'>[</span><span class='lbracket'>[</span><span class='id identifier rubyid_j'>j</span><span class='comma'>,</span> <span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_r'>r</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
      <span class='id identifier rubyid_perm'>perm</span><span class='lbracket'>[</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_j'>j</span><span class='rbracket'>]</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_perm'>perm</span><span class='lbracket'>[</span><span class='lbracket'>[</span><span class='id identifier rubyid_j'>j</span><span class='comma'>,</span> <span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
      <span class='id identifier rubyid_changed_2x2'>changed_2x2</span> <span class='op'>=</span> <span class='kw'>true</span>
      <span class='kw'>next</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_changed_2x2'>changed_2x2</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='kw'>end</span>

  <span class='lbracket'>[</span><span class='id identifier rubyid_lu'>lu</span><span class='comma'>,</span> <span class='id identifier rubyid_d'>d</span><span class='comma'>,</span> <span class='id identifier rubyid_perm'>perm</span><span class='period'>.</span><span class='id identifier rubyid_sort_index'>sort_index</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="lstsq-class_method">
  
    .<strong>lstsq</strong>(a, b, driver: &#39;lsd&#39;, rcond: -1))  &#x21d2; <tt>[x, resids, rank, s]</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Computes the minimum-norm solution to a linear least squares
problem:</p>

<pre class="code ruby"><code class="ruby">    minimize 2-norm(| b - A*x |)
</code></pre>

<p>using the singular value decomposition (SVD) of A.
A is an M-by-N matrix which may be rank-deficient.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>a</span>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>m-by-n matrix A (&gt;= 2-dimensinal NArray)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>b</span>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>m-by-nrhs right-hand-side matrix b
(&gt;= 1-dimensinal NArray)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>driver</span>
      
      
        <span class='type'>(<tt>String or Symbol</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>choose LAPACK driver from
‘lsd’,’lss’,’lsy’ (optional, default=’lsd’)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>rcond</span>
      
      
        <span class='type'>(<tt>Float</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>(optional, default=-1)
RCOND is used to determine the effective rank of A.
Singular values <code>S(i) &lt;= RCOND*S(1)</code> are treated as zero.
If RCOND &lt; 0, machine precision is used instead.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>[x, resids, rank, s]</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><ul>
  <li><strong>x</strong> – The solution matrix/vector X.</li>
  <li><strong>resids</strong> – Sums of residues, squared 2-norm for each column in
<code>b - a x</code>. If matrix_rank(a) &lt; N or &gt; M, or ‘gelsy’ is used,
this is an empty array.</li>
  <li><strong>rank</strong> –  The effective rank of A, i.e.,
the number of singular values which are greater than RCOND*S(1).</li>
  <li><strong>s</strong> –  The singular values of A in decreasing order.
Returns nil if ‘gelsy’ is used.</li>
</ul>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


964
965
966
967
968
969
970
971
972
973
974
975
976
977
978
979
980
981
982
983
984
985
986
987
988
989
990
991
992
993
994
995
996
997
998
999
1000
1001
1002
1003
1004
1005
1006
1007
1008
1009
1010
1011
1012
1013
1014
1015
1016
1017
1018
1019
1020
1021
1022
1023
1024</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/numo/linalg/function.rb', line 964</span>

<span class='kw'>def</span> <span class='id identifier rubyid_lstsq'>lstsq</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='comma'>,</span> <span class='label'>driver:</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>lsd</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>rcond:</span><span class='op'>-</span><span class='int'>1</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='const'>NArray</span><span class='period'>.</span><span class='id identifier rubyid_asarray'>asarray</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_b'>b</span> <span class='op'>=</span> <span class='const'>NArray</span><span class='period'>.</span><span class='id identifier rubyid_asarray'>asarray</span><span class='lparen'>(</span><span class='id identifier rubyid_b'>b</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_b_orig'>b_orig</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_b'>b</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='op'>==</span><span class='int'>1</span>
    <span class='id identifier rubyid_b_orig'>b_orig</span> <span class='op'>=</span> <span class='id identifier rubyid_b'>b</span>
    <span class='id identifier rubyid_b'>b</span> <span class='op'>=</span> <span class='id identifier rubyid_b_orig'>b_orig</span><span class='lbracket'>[</span><span class='kw'>true</span><span class='comma'>,</span><span class='symbol'>:new</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_m'>m</span> <span class='op'>=</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='lbracket'>[</span><span class='op'>-</span><span class='int'>2</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_n'>n</span> <span class='op'>=</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='lbracket'>[</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span>
  <span class='comment'>#nrhs = b.shape[-1]
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_m'>m</span> <span class='op'>!=</span> <span class='id identifier rubyid_b'>b</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='lbracket'>[</span><span class='op'>-</span><span class='int'>2</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>NArray</span><span class='op'>::</span><span class='const'>ShapeError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>size mismatch: A-row and B-row</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_m'>m</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_n'>n</span>   <span class='comment'># need to extend b matrix
</span>    <span class='id identifier rubyid_shp'>shp</span> <span class='op'>=</span> <span class='id identifier rubyid_b'>b</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span>
    <span class='id identifier rubyid_shp'>shp</span><span class='lbracket'>[</span><span class='op'>-</span><span class='int'>2</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_n'>n</span>
    <span class='id identifier rubyid_b2'>b2</span> <span class='op'>=</span> <span class='id identifier rubyid_b'>b</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_zeros'>zeros</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_shp'>shp</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_b2'>b2</span><span class='lbracket'>[</span><span class='kw'>false</span><span class='comma'>,</span><span class='int'>0</span><span class='op'>...</span><span class='id identifier rubyid_m'>m</span><span class='comma'>,</span><span class='kw'>true</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_b'>b</span>
    <span class='id identifier rubyid_b'>b</span> <span class='op'>=</span> <span class='id identifier rubyid_b2'>b2</span>
  <span class='kw'>end</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_driver'>driver</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
  <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^(ge)?lsd$</span><span class='regexp_end'>/i</span></span>
    <span class='comment'># x, s, rank, info
</span>    <span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='id identifier rubyid_s'>s</span><span class='comma'>,</span> <span class='id identifier rubyid_rank'>rank</span><span class='comma'>,</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Linalg/Lapack.html" title="Numo::Linalg::Lapack (module)">Lapack</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Lapack.html#call-class_method" title="Numo::Linalg::Lapack.call (method)">call</a></span></span><span class='lparen'>(</span><span class='symbol'>:gelsd</span><span class='comma'>,</span> <span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='comma'>,</span> <span class='label'>rcond:</span><span class='id identifier rubyid_rcond'>rcond</span><span class='rparen'>)</span>
  <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^(ge)?lss$</span><span class='regexp_end'>/i</span></span>
    <span class='comment'># v, x, s, rank, info
</span>    <span class='id identifier rubyid__'>_</span><span class='comma'>,</span> <span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='id identifier rubyid_s'>s</span><span class='comma'>,</span> <span class='id identifier rubyid_rank'>rank</span><span class='comma'>,</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Linalg/Lapack.html" title="Numo::Linalg::Lapack (module)">Lapack</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Lapack.html#call-class_method" title="Numo::Linalg::Lapack.call (method)">call</a></span></span><span class='lparen'>(</span><span class='symbol'>:gelss</span><span class='comma'>,</span> <span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='comma'>,</span> <span class='label'>rcond:</span><span class='id identifier rubyid_rcond'>rcond</span><span class='rparen'>)</span>
  <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^(ge)?lsy$</span><span class='regexp_end'>/i</span></span>
    <span class='id identifier rubyid_jpvt'>jpvt</span> <span class='op'>=</span> <span class='const'>Int32</span><span class='period'>.</span><span class='id identifier rubyid_zeros'>zeros</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_a'>a</span><span class='lbracket'>[</span><span class='kw'>false</span><span class='comma'>,</span><span class='int'>0</span><span class='comma'>,</span><span class='kw'>true</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='rparen'>)</span>
    <span class='comment'># v, x, jpvt, rank, info
</span>    <span class='id identifier rubyid__'>_</span><span class='comma'>,</span> <span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='id identifier rubyid__'>_</span><span class='comma'>,</span> <span class='id identifier rubyid_rank'>rank</span><span class='comma'>,</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Linalg/Lapack.html" title="Numo::Linalg::Lapack (module)">Lapack</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Lapack.html#call-class_method" title="Numo::Linalg::Lapack.call (method)">call</a></span></span><span class='lparen'>(</span><span class='symbol'>:gelsy</span><span class='comma'>,</span> <span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='comma'>,</span> <span class='id identifier rubyid_jpvt'>jpvt</span><span class='comma'>,</span> <span class='label'>rcond:</span><span class='id identifier rubyid_rcond'>rcond</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>invalid driver: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_driver'>driver</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_resids'>resids</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_m'>m</span> <span class='op'>&gt;</span> <span class='id identifier rubyid_n'>n</span>
    <span class='kw'>if</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>ls(d|s)$</span><span class='regexp_end'>/i</span></span> <span class='op'>=~</span> <span class='id identifier rubyid_driver'>driver</span>
      <span class='kw'>case</span> <span class='id identifier rubyid_rank'>rank</span>
      <span class='kw'>when</span> <span class='id identifier rubyid_n'>n</span>
        <span class='id identifier rubyid_resids'>resids</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_x'>x</span><span class='lbracket'>[</span><span class='id identifier rubyid_n'>n</span><span class='op'>..</span><span class='op'>-</span><span class='int'>1</span><span class='comma'>,</span><span class='kw'>true</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_abs'>abs</span><span class='op'>**</span><span class='int'>2</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_sum'>sum</span><span class='lparen'>(</span><span class='label'>axis:</span><span class='int'>0</span><span class='rparen'>)</span>
      <span class='kw'>when</span> <span class='const'>NArray</span>
        <span class='kw'>if</span> <span class='kw'>true</span>
          <span class='id identifier rubyid_resids'>resids</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_x'>x</span><span class='lbracket'>[</span><span class='kw'>false</span><span class='comma'>,</span><span class='id identifier rubyid_n'>n</span><span class='op'>..</span><span class='op'>-</span><span class='int'>1</span><span class='comma'>,</span><span class='kw'>true</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_abs'>abs</span><span class='op'>**</span><span class='int'>2</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_sum'>sum</span><span class='lparen'>(</span><span class='label'>axis:</span><span class='op'>-</span><span class='int'>2</span><span class='rparen'>)</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_resids'>resids</span> <span class='op'>=</span> <span class='id identifier rubyid_x'>x</span><span class='lbracket'>[</span><span class='kw'>false</span><span class='comma'>,</span><span class='int'>0</span><span class='comma'>,</span><span class='kw'>true</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_new_zeros'>new_zeros</span>
          <span class='id identifier rubyid_mask'>mask</span> <span class='op'>=</span> <span class='id identifier rubyid_rank'>rank</span><span class='period'>.</span><span class='id identifier rubyid_eq'>eq</span><span class='lparen'>(</span><span class='id identifier rubyid_n'>n</span><span class='rparen'>)</span>
          <span class='comment'># NArray does not suppurt this yet.
</span>          <span class='id identifier rubyid_resids'>resids</span><span class='lbracket'>[</span><span class='id identifier rubyid_mask'>mask</span><span class='comma'>,</span><span class='kw'>true</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_x'>x</span><span class='lbracket'>[</span><span class='id identifier rubyid_mask'>mask</span><span class='comma'>,</span><span class='id identifier rubyid_n'>n</span><span class='op'>..</span><span class='op'>-</span><span class='int'>1</span><span class='comma'>,</span><span class='kw'>true</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_abs'>abs</span><span class='op'>**</span><span class='int'>2</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_sum'>sum</span><span class='lparen'>(</span><span class='label'>axis:</span><span class='op'>-</span><span class='int'>2</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_x'>x</span> <span class='op'>=</span> <span class='id identifier rubyid_x'>x</span><span class='lbracket'>[</span><span class='kw'>false</span><span class='comma'>,</span><span class='int'>0</span><span class='op'>...</span><span class='id identifier rubyid_n'>n</span><span class='comma'>,</span><span class='kw'>true</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_b_orig'>b_orig</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_b_orig'>b_orig</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='op'>==</span><span class='int'>1</span>
    <span class='id identifier rubyid_x'>x</span> <span class='op'>=</span> <span class='id identifier rubyid_x'>x</span><span class='lbracket'>[</span><span class='kw'>true</span><span class='comma'>,</span><span class='int'>0</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_resids'>resids</span> <span class='op'>&amp;&amp;=</span> <span class='id identifier rubyid_resids'>resids</span><span class='lbracket'>[</span><span class='kw'>false</span><span class='comma'>,</span><span class='int'>0</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
  <span class='lbracket'>[</span><span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='id identifier rubyid_resids'>resids</span><span class='comma'>,</span> <span class='id identifier rubyid_rank'>rank</span><span class='comma'>,</span> <span class='id identifier rubyid_s'>s</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="lu-class_method">
  
    .<strong>lu</strong>(a, permute_l: false)  &#x21d2; <tt>[p,l,u]</tt>, <tt>[pl,u]</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Computes an LU factorization of a M-by-N matrix A
using partial pivoting with row interchanges.</p>

<p>The factorization has the form</p>

<pre class="code ruby"><code class="ruby"><span class='const'>A</span> <span class='op'>=</span> <span class='const'>P</span> <span class='op'>*</span> <span class='const'>L</span> <span class='op'>*</span> <span class='const'>U</span>
</code></pre>

<p>where P is a permutation matrix, L is lower triangular with unit
diagonal elements (lower trapezoidal if m &gt; n), and U is upper
triangular (upper trapezoidal if m &lt; n).</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>a</span>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>m-by-n matrix A (&gt;= 2-dimensinal NArray)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>permute_l</span>
      
      
        <span class='type'>(<tt>Bool</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>(optional) If true, perform the matrix product of P and L.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>[p,l,u]</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>if permute_l == false</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt>[pl,u]</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>if permute_l == true</p>

<ul>
  <li><strong>p</strong> [Numo::NArray] – The permutation matrix P.</li>
  <li><strong>l</strong> [Numo::NArray] – The factor L.</li>
  <li><strong>u</strong> [Numo::NArray] – The factor U.</li>
</ul>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>NArray::ShapeError</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


319
320
321
322
323
324
325
326
327
328
329
330</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/numo/linalg/function.rb', line 319</span>

<span class='kw'>def</span> <span class='id identifier rubyid_lu'>lu</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='label'>permute_l:</span> <span class='kw'>false</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>NArray</span><span class='op'>::</span><span class='const'>ShapeError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>2-d array is required</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_ndim'>ndim</span> <span class='op'>&lt;</span> <span class='int'>2</span>
  <span class='id identifier rubyid_m'>m</span><span class='comma'>,</span> <span class='id identifier rubyid_n'>n</span> <span class='op'>=</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span>
  <span class='id identifier rubyid_k'>k</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_m'>m</span><span class='comma'>,</span> <span class='id identifier rubyid_n'>n</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_min'>min</span>
  <span class='id identifier rubyid_lu'>lu</span><span class='comma'>,</span> <span class='id identifier rubyid_ip'>ip</span> <span class='op'>=</span> <span class='id identifier rubyid_lu_fact'>lu_fact</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_l'>l</span> <span class='op'>=</span> <span class='id identifier rubyid_lu'>lu</span><span class='period'>.</span><span class='id identifier rubyid_tril'>tril</span><span class='period'>.</span><span class='id identifier rubyid_tap'>tap</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_mat'>mat</span><span class='op'>|</span> <span class='id identifier rubyid_mat'>mat</span><span class='lbracket'>[</span><span class='id identifier rubyid_mat'>mat</span><span class='period'>.</span><span class='id identifier rubyid_diag_indices'>diag_indices</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='float'>1.0</span> <span class='rbrace'>}</span><span class='lbracket'>[</span><span class='kw'>true</span><span class='comma'>,</span> <span class='int'>0</span><span class='op'>...</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_u'>u</span> <span class='op'>=</span> <span class='id identifier rubyid_lu'>lu</span><span class='period'>.</span><span class='id identifier rubyid_triu'>triu</span><span class='lbracket'>[</span><span class='int'>0</span><span class='op'>...</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='int'>0</span><span class='op'>...</span><span class='id identifier rubyid_n'>n</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_p'>p</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Numo.html" title="Numo (module)">Numo</a></span></span><span class='op'>::</span><span class='const'>DFloat</span><span class='period'>.</span><span class='id identifier rubyid_eye'>eye</span><span class='lparen'>(</span><span class='id identifier rubyid_m'>m</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_tap'>tap</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_mat'>mat</span><span class='op'>|</span>
        <span class='id identifier rubyid_ip'>ip</span><span class='period'>.</span><span class='id identifier rubyid_to_a'>to_a</span><span class='period'>.</span><span class='id identifier rubyid_each_with_index'>each_with_index</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='comma'>,</span> <span class='id identifier rubyid_j'>j</span><span class='op'>|</span> <span class='id identifier rubyid_mat'>mat</span><span class='lbracket'>[</span><span class='kw'>true</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span> <span class='op'>-</span> <span class='int'>1</span><span class='comma'>,</span> <span class='id identifier rubyid_j'>j</span><span class='rbracket'>]</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_mat'>mat</span><span class='lbracket'>[</span><span class='kw'>true</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='id identifier rubyid_j'>j</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span> <span class='op'>-</span> <span class='int'>1</span><span class='rbracket'>]</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span> <span class='rbrace'>}</span>
      <span class='kw'>end</span>
  <span class='id identifier rubyid_permute_l'>permute_l</span> <span class='op'>?</span> <span class='lbracket'>[</span><span class='id identifier rubyid_p'>p</span><span class='period'>.</span><span class='id identifier rubyid_dot'>dot</span><span class='lparen'>(</span><span class='id identifier rubyid_l'>l</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_u'>u</span><span class='rbracket'>]</span> <span class='op'>:</span> <span class='lbracket'>[</span><span class='id identifier rubyid_p'>p</span><span class='comma'>,</span> <span class='id identifier rubyid_l'>l</span><span class='comma'>,</span> <span class='id identifier rubyid_u'>u</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="lu_fact-class_method">
  
    .<strong>lu_fact</strong>(a)  &#x21d2; <tt>[<span class='object_link'><a href="#lu-class_method" title="Numo::Linalg.lu (method)">lu</a></span>, ipiv]</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Computes an LU factorization of a M-by-N matrix A
using partial pivoting with row interchanges.</p>

<p>The factorization has the form</p>

<pre class="code ruby"><code class="ruby"><span class='const'>A</span> <span class='op'>=</span> <span class='const'>P</span> <span class='op'>*</span> <span class='const'>L</span> <span class='op'>*</span> <span class='const'>U</span>
</code></pre>

<p>where P is a permutation matrix, L is lower triangular with unit
diagonal elements (lower trapezoidal if m &gt; n), and U is upper
triangular (upper trapezoidal if m &lt; n).</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>a</span>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>m-by-n matrix A (&gt;= 2-dimensinal NArray)</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>[<span class='object_link'><a href="#lu-class_method" title="Numo::Linalg.lu (method)">lu</a></span>, ipiv]</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><ul>
  <li><strong>lu</strong> [Numo::NArray] – The factors L and U from the factorization
<code>A = P*L*U</code>; the unit diagonal elements of L are not stored.</li>
  <li><strong>ipiv</strong> [Numo::NArray] – The pivot indices; for 1 &lt;= i &lt;= min(M,N),
 row i of the matrix was interchanged with row IPIV(i).</li>
</ul>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


350
351
352</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/numo/linalg/function.rb', line 350</span>

<span class='kw'>def</span> <span class='id identifier rubyid_lu_fact'>lu_fact</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='rparen'>)</span>
  <span class='const'><span class='object_link'><a href="Linalg/Lapack.html" title="Numo::Linalg::Lapack (module)">Lapack</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Lapack.html#call-class_method" title="Numo::Linalg::Lapack.call (method)">call</a></span></span><span class='lparen'>(</span><span class='symbol'>:getrf</span><span class='comma'>,</span> <span class='id identifier rubyid_a'>a</span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='op'>..</span><span class='int'>1</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="lu_inv-class_method">
  
    .<strong>lu_inv</strong>(lu, ipiv)  &#x21d2; <tt>Numo::NArray</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Computes the inverse of a matrix using the LU factorization
computed by Numo::Linalg.lu_fact.</p>

<p>This method inverts U and then computes inv(A) by solving the system</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_inv'>inv</span><span class='lparen'>(</span><span class='const'>A</span><span class='rparen'>)</span><span class='op'>*</span><span class='const'>L</span> <span class='op'>=</span> <span class='id identifier rubyid_inv'>inv</span><span class='lparen'>(</span><span class='const'>U</span><span class='rparen'>)</span>
</code></pre>

<p>for inv(A).</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>lu</span>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>matrix containing the factors L and U
from the factorization <code>A = P*L*U</code> as computed by
Numo::Linalg.lu_fact.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>ipiv</span>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The pivot indices from
Numo::Linalg.lu_fact; for 1&lt;=i&lt;=N, row i of the matrix was
interchanged with row IPIV(i).</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the inverse of the original matrix A.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


371
372
373</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/numo/linalg/function.rb', line 371</span>

<span class='kw'>def</span> <span class='id identifier rubyid_lu_inv'>lu_inv</span><span class='lparen'>(</span><span class='id identifier rubyid_lu'>lu</span><span class='comma'>,</span> <span class='id identifier rubyid_ipiv'>ipiv</span><span class='rparen'>)</span>
  <span class='const'><span class='object_link'><a href="Linalg/Lapack.html" title="Numo::Linalg::Lapack (module)">Lapack</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Lapack.html#call-class_method" title="Numo::Linalg::Lapack.call (method)">call</a></span></span><span class='lparen'>(</span><span class='symbol'>:getri</span><span class='comma'>,</span> <span class='id identifier rubyid_lu'>lu</span><span class='comma'>,</span> <span class='id identifier rubyid_ipiv'>ipiv</span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="lu_solve-class_method">
  
    .<strong>lu_solve</strong>(lu, ipiv, b, trans: &quot;N&quot;)  &#x21d2; <tt>Numo::NArray</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Solves a system of linear equations</p>

<pre class="code ruby"><code class="ruby"><span class='const'>A</span> <span class='op'>*</span> <span class='const'>X</span> <span class='op'>=</span> <span class='const'>B</span>  <span class='kw'>or</span>  <span class='const'>A</span><span class='op'>**</span><span class='const'>T</span> <span class='op'>*</span> <span class='const'>X</span> <span class='op'>=</span> <span class='const'>B</span>
</code></pre>

<p>with a N-by-N matrix A using the LU factorization computed by
Numo::Linalg.lu_fact</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>lu</span>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>matrix containing the factors L and U
from the factorization <code>A = P*L*U</code> as computed by
Numo::Linalg.lu_fact.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>ipiv</span>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The pivot indices from
Numo::Linalg.lu_fact; for 1&lt;=i&lt;=N, row i of the matrix was
interchanged with row IPIV(i).</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>b</span>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the right hand side matrix B.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>trans</span>
      
      
        <span class='type'>(<tt>String or Symbol</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>Specifies the form of the system of equations:
  - If ‘N’: <code>A * X = B</code> (No transpose).
  - If ‘T’: <code>A*\*T* X = B</code> (Transpose).
  - If ‘C’: <code>A*\*T* X = B</code> (Conjugate transpose = Transpose).</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the solution matrix X.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


396
397
398</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/numo/linalg/function.rb', line 396</span>

<span class='kw'>def</span> <span class='id identifier rubyid_lu_solve'>lu_solve</span><span class='lparen'>(</span><span class='id identifier rubyid_lu'>lu</span><span class='comma'>,</span> <span class='id identifier rubyid_ipiv'>ipiv</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='comma'>,</span> <span class='label'>trans:</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>N</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='const'><span class='object_link'><a href="Linalg/Lapack.html" title="Numo::Linalg::Lapack (module)">Lapack</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Lapack.html#call-class_method" title="Numo::Linalg::Lapack.call (method)">call</a></span></span><span class='lparen'>(</span><span class='symbol'>:getrs</span><span class='comma'>,</span> <span class='id identifier rubyid_lu'>lu</span><span class='comma'>,</span> <span class='id identifier rubyid_ipiv'>ipiv</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='comma'>,</span> <span class='label'>trans:</span><span class='id identifier rubyid_trans'>trans</span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="matmul-class_method">
  
    .<strong>matmul</strong>(a, b)  &#x21d2; <tt>Numo::NArray</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Matrix product.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>a</span>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>matrix (&gt;= 2-dimensinal NArray)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>b</span>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>matrix (&gt;= 2-dimensinal NArray)</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>result of matrix product</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


108
109
110</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/numo/linalg/function.rb', line 108</span>

<span class='kw'>def</span> <span class='id identifier rubyid_matmul'>matmul</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='rparen'>)</span>
  <span class='const'><span class='object_link'><a href="Linalg/Blas.html" title="Numo::Linalg::Blas (module)">Blas</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Blas.html#call-class_method" title="Numo::Linalg::Blas.call (method)">call</a></span></span><span class='lparen'>(</span><span class='symbol'>:gemm</span><span class='comma'>,</span> <span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="matrix_power-class_method">
  
    .<strong>matrix_power</strong>(a, n)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Compute a square matrix <code>a</code> to the power <code>n</code>.</p>

<ul>
  <li>If n &gt; 0: return <code>a**n</code>.</li>
  <li>If n == 0: return identity matrix.</li>
  <li>If n &lt; 0: return <code>(a*\*-1)*\*n.abs</code>.</li>
</ul>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code>i = Numo::DFloat[[0, 1], [-1, 0]]
=&gt; Numo::DFloat#shape=[2,2]
[[0, 1],
 [-1, 0]]
Numo::Linalg.matrix_power(i,3)
=&gt; Numo::DFloat#shape=[2,2]
[[0, -1],
 [1, 0]]
Numo::Linalg.matrix_power(i,0)
=&gt; Numo::DFloat#shape=[2,2]
[[1, 0],
 [0, 1]]
Numo::Linalg.matrix_power(i,-3)
=&gt; Numo::DFloat#shape=[2,2]
[[0, 1],
 [-1, 0]]

q = Numo::DFloat.zeros(4,4)
q[0..1,0..1] = -i
q[2..3,2..3] = i
q
=&gt; Numo::DFloat#shape=[4,4]
[[-0, -1, 0, 0],
 [1, -0, 0, 0],
 [0, 0, 0, 1],
 [0, 0, -1, 0]]
Numo::Linalg.matrix_power(q,2)
=&gt; Numo::DFloat#shape=[4,4]
[[-1, 0, 0, 0],
 [0, -1, 0, 0],
 [0, 0, -1, 0],
 [0, 0, 0, -1]]</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>a</span>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>square matrix (&gt;= 2-dimensinal NArray).</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>n</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the exponent.</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/numo/linalg/function.rb', line 154</span>

<span class='kw'>def</span> <span class='id identifier rubyid_matrix_power'>matrix_power</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_n'>n</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='const'>NArray</span><span class='period'>.</span><span class='id identifier rubyid_asarray'>asarray</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_m'>m</span><span class='comma'>,</span><span class='id identifier rubyid_k'>k</span> <span class='op'>=</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='lbracket'>[</span><span class='op'>-</span><span class='int'>2</span><span class='op'>..</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_m'>m</span><span class='op'>==</span><span class='id identifier rubyid_k'>k</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>NArray</span><span class='op'>::</span><span class='const'>ShapeError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>input must be a square array</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='kw'>unless</span> <span class='const'>Integer</span><span class='op'>===</span><span class='id identifier rubyid_n'>n</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>exponent must be an integer</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_n'>n</span> <span class='op'>==</span> <span class='int'>0</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_eye'>eye</span><span class='lparen'>(</span><span class='id identifier rubyid_m'>m</span><span class='rparen'>)</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_n'>n</span> <span class='op'>&lt;</span> <span class='int'>0</span>
    <span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='id identifier rubyid_inv'>inv</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_n'>n</span> <span class='op'>=</span> <span class='id identifier rubyid_n'>n</span><span class='period'>.</span><span class='id identifier rubyid_abs'>abs</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_n'>n</span> <span class='op'>&lt;=</span> <span class='int'>3</span>
    <span class='id identifier rubyid_r'>r</span> <span class='op'>=</span> <span class='id identifier rubyid_a'>a</span>
    <span class='lparen'>(</span><span class='id identifier rubyid_n'>n</span><span class='op'>-</span><span class='int'>1</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span> <span class='kw'>do</span>
      <span class='id identifier rubyid_r'>r</span> <span class='op'>=</span> <span class='id identifier rubyid_matmul'>matmul</span><span class='lparen'>(</span><span class='id identifier rubyid_r'>r</span><span class='comma'>,</span><span class='id identifier rubyid_a'>a</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='kw'>while</span> <span class='lparen'>(</span><span class='id identifier rubyid_n'>n</span> <span class='op'>&amp;</span> <span class='int'>1</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='int'>0</span>
      <span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='id identifier rubyid_matmul'>matmul</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span><span class='id identifier rubyid_a'>a</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_n'>n</span> <span class='op'>&gt;&gt;=</span> <span class='int'>1</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_r'>r</span> <span class='op'>=</span> <span class='id identifier rubyid_a'>a</span>
    <span class='kw'>while</span> <span class='id identifier rubyid_n'>n</span> <span class='op'>!=</span> <span class='int'>0</span>
      <span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='id identifier rubyid_matmul'>matmul</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span><span class='id identifier rubyid_a'>a</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_n'>n</span> <span class='op'>&gt;&gt;=</span> <span class='int'>1</span>
      <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_n'>n</span> <span class='op'>&amp;</span> <span class='int'>1</span><span class='rparen'>)</span> <span class='op'>!=</span> <span class='int'>0</span>
        <span class='id identifier rubyid_r'>r</span> <span class='op'>=</span> <span class='id identifier rubyid_matmul'>matmul</span><span class='lparen'>(</span><span class='id identifier rubyid_r'>r</span><span class='comma'>,</span><span class='id identifier rubyid_a'>a</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_r'>r</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="matrix_rank-class_method">
  
    .<strong>matrix_rank</strong>(m, tol: nil, driver: &#39;svd&#39;)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Compute matrix rank of array using SVD
<em>Rank</em> is the number of singular values greater than <em>tol</em>.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>m</span>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>matrix (&gt;= 2-dimensional NArray)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>tol</span>
      
      
        <span class='type'>(<tt>Float</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>threshold below which singular values are
considered to be zero. If <em>tol</em> is nil,
<code>tol = sing_vals.max() * m.shape.max * EPSILON</code>.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>driver</span>
      
      
        <span class='type'>(<tt>String or Symbol</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>choose LAPACK solver from ‘svd’,
‘sdd’. (optional, default=’svd’)</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


856
857
858
859
860
861
862
863
864
865
866
867
868
869
870
871
872
873</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/numo/linalg/function.rb', line 856</span>

<span class='kw'>def</span> <span class='id identifier rubyid_matrix_rank'>matrix_rank</span><span class='lparen'>(</span><span class='id identifier rubyid_m'>m</span><span class='comma'>,</span> <span class='label'>tol:</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>driver:</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>svd</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_m'>m</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Numo.html" title="Numo (module)">Numo</a></span></span><span class='op'>::</span><span class='const'>NArray</span><span class='period'>.</span><span class='id identifier rubyid_asarray'>asarray</span><span class='lparen'>(</span><span class='id identifier rubyid_m'>m</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_m'>m</span><span class='period'>.</span><span class='id identifier rubyid_ndim'>ndim</span> <span class='op'>&lt;</span> <span class='int'>2</span>
    <span class='id identifier rubyid_m'>m</span><span class='period'>.</span><span class='id identifier rubyid_ne'>ne</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span> <span class='op'>?</span> <span class='int'>1</span> <span class='op'>:</span> <span class='int'>0</span>
  <span class='kw'>else</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_driver'>driver</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
    <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^(ge)?sdd$</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>turbo</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Linalg/Lapack.html" title="Numo::Linalg::Lapack (module)">Lapack</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Lapack.html#call-class_method" title="Numo::Linalg::Lapack.call (method)">call</a></span></span><span class='lparen'>(</span><span class='symbol'>:gesdd</span><span class='comma'>,</span> <span class='id identifier rubyid_m'>m</span><span class='comma'>,</span> <span class='label'>jobz:</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>N</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
    <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^(ge)?svd$</span><span class='regexp_end'>/</span></span>
      <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Linalg/Lapack.html" title="Numo::Linalg::Lapack (module)">Lapack</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Lapack.html#call-class_method" title="Numo::Linalg::Lapack.call (method)">call</a></span></span><span class='lparen'>(</span><span class='symbol'>:gesvd</span><span class='comma'>,</span> <span class='id identifier rubyid_m'>m</span><span class='comma'>,</span> <span class='label'>jobu:</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>N</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>jobvt:</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>N</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>invalid driver: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_driver'>driver</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_tol'>tol</span> <span class='op'>||=</span> <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_max'>max</span><span class='lparen'>(</span><span class='label'>axis:</span><span class='op'>-</span><span class='int'>1</span><span class='comma'>,</span> <span class='label'>keepdims:</span><span class='kw'>true</span><span class='rparen'>)</span> <span class='op'>*</span>
      <span class='lparen'>(</span><span class='id identifier rubyid_m'>m</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='lbracket'>[</span><span class='op'>-</span><span class='int'>2</span><span class='op'>..</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_max'>max</span> <span class='op'>*</span> <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='op'>::</span><span class='const'>EPSILON</span><span class='rparen'>)</span>
    <span class='lparen'>(</span><span class='id identifier rubyid_s'>s</span> <span class='op'>&gt;</span> <span class='id identifier rubyid_tol'>tol</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='lparen'>(</span><span class='label'>axis:</span><span class='op'>-</span><span class='int'>1</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="norm-class_method">
  
    .<strong>norm</strong>(a, ord = nil, axis: nil, keepdims: false)  &#x21d2; <tt>Numo::NArray</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Compute matrix or vector norm.</p>

<pre class="code ruby"><code class="ruby">|  ord  |  matrix norm           | vector norm                 |
| ----- | ---------------------- | --------------------------- |
|  nil  | Frobenius norm         | 2-norm                      |
| &#39;fro&#39; | Frobenius norm         |  -                          |
| &#39;inf&#39; | x.abs.sum(axis:-1).max | x.abs.max                   |
|    0  |  -                     | (x.ne 0).sum                |
|    1  | x.abs.sum(axis:-2).max | same as below               |
|    2  | 2-norm (max sing_vals) | same as below               |
| other |  -                     | (x.abs**ord).sum**(1.0/ord) |
</code></pre>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>a</span>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>matrix or vector (&gt;= 1-dimensinal NArray)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>ord</span>
      
      
        <span class='type'>(<tt>String or Symbol</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Order of the norm .</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>axis</span>
      
      
        <span class='type'>(<tt>Integer or Array</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>Applied axes (optional).</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>keepdims</span>
      
      
        <span class='type'>(<tt>Bool</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>If true, the applied axes are left in
result with size one (optional).</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>norm result</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


654
655
656
657
658
659
660
661
662
663
664
665
666
667
668
669
670
671
672
673
674
675
676
677
678
679
680
681
682
683
684
685
686
687
688
689
690
691
692
693
694
695
696
697
698
699
700
701
702
703
704
705
706
707
708
709
710
711
712
713
714
715
716
717
718
719
720
721
722
723
724
725
726
727
728
729
730
731
732
733
734
735
736
737
738
739
740
741
742
743
744
745
746
747
748
749
750
751
752
753
754
755
756
757
758
759
760</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/numo/linalg/function.rb', line 654</span>

<span class='kw'>def</span> <span class='id identifier rubyid_norm'>norm</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_ord'>ord</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>axis:</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>keepdims:</span><span class='kw'>false</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Numo.html" title="Numo (module)">Numo</a></span></span><span class='op'>::</span><span class='const'>NArray</span><span class='period'>.</span><span class='id identifier rubyid_asarray'>asarray</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='rparen'>)</span>

  <span class='comment'># check axis
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_axis'>axis</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_axis'>axis</span>
    <span class='kw'>when</span> <span class='const'>Integer</span>
      <span class='id identifier rubyid_axis'>axis</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_axis'>axis</span><span class='rbracket'>]</span>
    <span class='kw'>when</span> <span class='const'>Array</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_axis'>axis</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>&lt;</span> <span class='int'>1</span> <span class='op'>||</span> <span class='id identifier rubyid_axis'>axis</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>&gt;</span> <span class='int'>2</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgmentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>axis option should be 1- or 2-element array</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>end</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>invalid option for axis: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_axis'>axis</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
    <span class='comment'># swap axes
</span>    <span class='kw'>if</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_ndim'>ndim</span> <span class='op'>&gt;</span> <span class='int'>1</span>
      <span class='id identifier rubyid_idx'>idx</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='int'>0</span><span class='op'>...</span><span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_ndim'>ndim</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_a'>to_a</span>
      <span class='id identifier rubyid_tmp'>tmp</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_axis'>axis</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
        <span class='id identifier rubyid_x'>x</span> <span class='op'>=</span> <span class='id identifier rubyid_idx'>idx</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
          <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgmentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>axis contains same dimension</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_tmp'>tmp</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_x'>x</span>
        <span class='id identifier rubyid_idx'>idx</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='kw'>nil</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_idx'>idx</span><span class='period'>.</span><span class='id identifier rubyid_compact!'>compact!</span>
      <span class='id identifier rubyid_idx'>idx</span><span class='period'>.</span><span class='id identifier rubyid_concat'>concat</span><span class='lparen'>(</span><span class='id identifier rubyid_tmp'>tmp</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_transpose'>transpose</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_idx'>idx</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_ndim'>ndim</span>
    <span class='kw'>when</span> <span class='int'>0</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>zero-dimensional array</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='int'>1</span>
      <span class='id identifier rubyid_axis'>axis</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_axis'>axis</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='op'>-</span><span class='int'>2</span><span class='comma'>,</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='comment'># calculate norm
</span>  <span class='kw'>case</span> <span class='id identifier rubyid_axis'>axis</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>

  <span class='kw'>when</span> <span class='int'>1</span>  <span class='comment'># vector
</span>    <span class='id identifier rubyid_k'>k</span> <span class='op'>=</span> <span class='id identifier rubyid_keepdims'>keepdims</span>
    <span class='id identifier rubyid_ord'>ord</span> <span class='op'>||=</span> <span class='int'>2</span>  <span class='comment'># default
</span>    <span class='kw'>case</span> <span class='id identifier rubyid_ord'>ord</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
    <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>0</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_r'>r</span> <span class='op'>=</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_cast'>cast</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_ne'>ne</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_sum'>sum</span><span class='lparen'>(</span><span class='label'>axis:</span><span class='op'>-</span><span class='int'>1</span><span class='comma'>,</span> <span class='label'>keepdims:</span><span class='id identifier rubyid_k'>k</span><span class='rparen'>)</span>
    <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_r'>r</span> <span class='op'>=</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_abs'>abs</span><span class='period'>.</span><span class='id identifier rubyid_sum'>sum</span><span class='lparen'>(</span><span class='label'>axis:</span><span class='op'>-</span><span class='int'>1</span><span class='comma'>,</span> <span class='label'>keepdims:</span><span class='id identifier rubyid_k'>k</span><span class='rparen'>)</span>
    <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>2</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_r'>r</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Linalg/Blas.html" title="Numo::Linalg::Blas (module)">Blas</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Blas.html#call-class_method" title="Numo::Linalg::Blas.call (method)">call</a></span></span><span class='lparen'>(</span><span class='symbol'>:nrm2</span><span class='comma'>,</span> <span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='label'>keepdims:</span><span class='id identifier rubyid_k'>k</span><span class='rparen'>)</span>
    <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^-?\d+$</span><span class='regexp_end'>/</span></span>
      <span class='id identifier rubyid_o'>o</span> <span class='op'>=</span> <span class='id identifier rubyid_ord'>ord</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
      <span class='id identifier rubyid_r'>r</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_abs'>abs</span><span class='op'>**</span><span class='id identifier rubyid_o'>o</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_sum'>sum</span><span class='lparen'>(</span><span class='label'>axis:</span><span class='op'>-</span><span class='int'>1</span><span class='comma'>,</span> <span class='label'>keepdims:</span><span class='id identifier rubyid_k'>k</span><span class='rparen'>)</span><span class='op'>**</span><span class='lparen'>(</span><span class='float'>1.0</span><span class='op'>/</span><span class='id identifier rubyid_o'>o</span><span class='rparen'>)</span>
    <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^inf(inity)?$</span><span class='regexp_end'>/i</span></span>
      <span class='id identifier rubyid_r'>r</span> <span class='op'>=</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_abs'>abs</span><span class='period'>.</span><span class='id identifier rubyid_max'>max</span><span class='lparen'>(</span><span class='label'>axis:</span><span class='op'>-</span><span class='int'>1</span><span class='comma'>,</span> <span class='label'>keepdims:</span><span class='id identifier rubyid_k'>k</span><span class='rparen'>)</span>
    <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^-inf(inity)?$</span><span class='regexp_end'>/i</span></span>
      <span class='id identifier rubyid_r'>r</span> <span class='op'>=</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_abs'>abs</span><span class='period'>.</span><span class='id identifier rubyid_min'>min</span><span class='lparen'>(</span><span class='label'>axis:</span><span class='op'>-</span><span class='int'>1</span><span class='comma'>,</span> <span class='label'>keepdims:</span><span class='id identifier rubyid_k'>k</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ord (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ord'>ord</span><span class='embexpr_end'>}</span><span class='tstring_content'>) is invalid for vector norm</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>

  <span class='kw'>when</span> <span class='int'>2</span>  <span class='comment'># matrix
</span>    <span class='kw'>if</span> <span class='id identifier rubyid_keepdims'>keepdims</span>
      <span class='id identifier rubyid_fixdims'>fixdims</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='kw'>true</span><span class='rbracket'>]</span> <span class='op'>*</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_ndim'>ndim</span>
      <span class='id identifier rubyid_axis'>axis</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_i'>i</span> <span class='op'>&lt;</span> <span class='op'>-</span><span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_ndim'>ndim</span> <span class='op'>||</span> <span class='id identifier rubyid_i'>i</span> <span class='op'>&gt;=</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_ndim'>ndim</span>
          <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgmentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>axis (%d) is out of range</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_fixdims'>fixdims</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='symbol'>:new</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_ord'>ord</span> <span class='op'>||=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>fro</span><span class='tstring_end'>&quot;</span></span>  <span class='comment'># default
</span>    <span class='kw'>case</span> <span class='id identifier rubyid_ord'>ord</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
    <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_r'>r</span><span class='comma'>,</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Linalg/Lapack.html" title="Numo::Linalg::Lapack (module)">Lapack</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Lapack.html#call-class_method" title="Numo::Linalg::Lapack.call (method)">call</a></span></span><span class='lparen'>(</span><span class='symbol'>:lange</span><span class='comma'>,</span> <span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>1</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-1</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_r'>r</span> <span class='op'>=</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_abs'>abs</span><span class='period'>.</span><span class='id identifier rubyid_sum'>sum</span><span class='lparen'>(</span><span class='label'>axis:</span><span class='op'>-</span><span class='int'>2</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_min'>min</span><span class='lparen'>(</span><span class='label'>axis:</span><span class='op'>-</span><span class='int'>1</span><span class='rparen'>)</span>
    <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>2</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_svd'>svd</span><span class='comma'>,</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Linalg/Lapack.html" title="Numo::Linalg::Lapack (module)">Lapack</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Lapack.html#call-class_method" title="Numo::Linalg::Lapack.call (method)">call</a></span></span><span class='lparen'>(</span><span class='symbol'>:gesvd</span><span class='comma'>,</span> <span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='label'>jobu:</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>N</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>jobvt:</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>N</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_r'>r</span> <span class='op'>=</span> <span class='id identifier rubyid_svd'>svd</span><span class='period'>.</span><span class='id identifier rubyid_max'>max</span><span class='lparen'>(</span><span class='label'>axis:</span><span class='op'>-</span><span class='int'>1</span><span class='rparen'>)</span>
    <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-2</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_svd'>svd</span><span class='comma'>,</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Linalg/Lapack.html" title="Numo::Linalg::Lapack (module)">Lapack</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Lapack.html#call-class_method" title="Numo::Linalg::Lapack.call (method)">call</a></span></span><span class='lparen'>(</span><span class='symbol'>:gesvd</span><span class='comma'>,</span> <span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='label'>jobu:</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>N</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>jobvt:</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>N</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_r'>r</span> <span class='op'>=</span> <span class='id identifier rubyid_svd'>svd</span><span class='period'>.</span><span class='id identifier rubyid_min'>min</span><span class='lparen'>(</span><span class='label'>axis:</span><span class='op'>-</span><span class='int'>1</span><span class='rparen'>)</span>
    <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^f(ro)?$</span><span class='regexp_end'>/i</span></span>
      <span class='id identifier rubyid_r'>r</span><span class='comma'>,</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Linalg/Lapack.html" title="Numo::Linalg::Lapack (module)">Lapack</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Lapack.html#call-class_method" title="Numo::Linalg::Lapack.call (method)">call</a></span></span><span class='lparen'>(</span><span class='symbol'>:lange</span><span class='comma'>,</span> <span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>F</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^inf(inity)?$</span><span class='regexp_end'>/i</span></span>
      <span class='id identifier rubyid_r'>r</span><span class='comma'>,</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Linalg/Lapack.html" title="Numo::Linalg::Lapack (module)">Lapack</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Lapack.html#call-class_method" title="Numo::Linalg::Lapack.call (method)">call</a></span></span><span class='lparen'>(</span><span class='symbol'>:lange</span><span class='comma'>,</span> <span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>I</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^-inf(inity)?$</span><span class='regexp_end'>/i</span></span>
      <span class='id identifier rubyid_r'>r</span> <span class='op'>=</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_abs'>abs</span><span class='period'>.</span><span class='id identifier rubyid_sum'>sum</span><span class='lparen'>(</span><span class='label'>axis:</span><span class='op'>-</span><span class='int'>1</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_min'>min</span><span class='lparen'>(</span><span class='label'>axis:</span><span class='op'>-</span><span class='int'>1</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ord (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ord'>ord</span><span class='embexpr_end'>}</span><span class='tstring_content'>) is invalid for matrix norm</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_keepdims'>keepdims</span>
      <span class='kw'>if</span> <span class='const'>NArray</span><span class='op'>===</span><span class='id identifier rubyid_r'>r</span>
        <span class='id identifier rubyid_r'>r</span> <span class='op'>=</span> <span class='id identifier rubyid_r'>r</span><span class='lbracket'>[</span><span class='op'>*</span><span class='id identifier rubyid_fixdims'>fixdims</span><span class='rbracket'>]</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_r'>r</span> <span class='op'>=</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='int'>1</span><span class='comma'>,</span><span class='int'>1</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_store'>store</span><span class='lparen'>(</span><span class='id identifier rubyid_r'>r</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_r'>r</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="pinv-class_method">
  
    .<strong>pinv</strong>(a, driver: &quot;svd&quot;, rcond: nil)  &#x21d2; <tt>Numo::NArray</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Compute the (Moore-Penrose) pseudo-inverse of a matrix
using svd or lstsq.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code>a = Numo::DFloat.new(5,3).rand_norm
=&gt; Numo::DFloat#shape=[5,3]
[[-0.581255, -0.168354, 0.586895],
 [-0.595142, -0.802802, -0.326106],
 [0.282922, 1.68427, 0.918499],
 [-0.0485384, -0.464453, -0.992194],
 [0.413794, -0.60717, -0.699695]]
b = Numo::Linalg.pinv(a,driver:&quot;svd&quot;)
=&gt; Numo::DFloat(view)#shape=[3,5]
[[-0.360863, -0.813125, -0.353367, -0.891963, 0.877253],
 [-0.227645, 0.162939, 0.696655, 0.787685, -0.469346],
 [0.408671, -0.308323, -0.337807, -1.13833, 0.228051]]
(a-a.dot(b.dot(a))).abs.max
=&gt; 5.551115123125783e-16</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>a</span>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>m-by-n matrix A (&gt;= 2-dimensinal NArray)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>driver</span>
      
      
        <span class='type'>(<tt>String or Symbol</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>choose LAPACK driver from
SVD (‘svd’, ‘sdd’) or Least square (‘lsd’,’lss’,’lsy’)
(optional, default=’svd’)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>rcond</span>
      
      
        <span class='type'>(<tt>Float</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>(optional, default=-1)
RCOND is used to determine the effective rank of A.
Singular values <code>S(i) &lt;= RCOND*S(1)</code> are treated as zero.
If RCOND &lt; 0, machine precision is used instead.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1054
1055
1056
1057
1058
1059
1060
1061
1062
1063
1064
1065
1066
1067
1068
1069
1070
1071
1072
1073
1074
1075
1076
1077
1078
1079
1080
1081
1082
1083
1084</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/numo/linalg/function.rb', line 1054</span>

<span class='kw'>def</span> <span class='id identifier rubyid_pinv'>pinv</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='label'>driver:</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>svd</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>rcond:</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='const'>NArray</span><span class='period'>.</span><span class='id identifier rubyid_asarray'>asarray</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_ndim'>ndim</span> <span class='op'>&lt;</span> <span class='int'>2</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>NArray</span><span class='op'>::</span><span class='const'>ShapeError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>2-d array is required</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_driver'>driver</span>
  <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^(ge)?s[dv]d$</span><span class='regexp_end'>/</span></span>
    <span class='id identifier rubyid_s'>s</span><span class='comma'>,</span> <span class='id identifier rubyid_u'>u</span><span class='comma'>,</span> <span class='id identifier rubyid_vh'>vh</span> <span class='op'>=</span> <span class='id identifier rubyid_svd'>svd</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='label'>driver:</span><span class='id identifier rubyid_driver'>driver</span><span class='comma'>,</span> <span class='label'>job:</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>S</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_rcond'>rcond</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='id identifier rubyid_rcond'>rcond</span> <span class='op'>&lt;</span> <span class='int'>0</span>
      <span class='id identifier rubyid_rcond'>rcond</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='lparen'>(</span><span class='const'>SFloat</span><span class='op'>===</span><span class='id identifier rubyid_s'>s</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='float'>1e3</span> <span class='op'>:</span> <span class='float'>1e6</span><span class='rparen'>)</span> <span class='op'>*</span> <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='op'>::</span><span class='const'>EPSILON</span>
    <span class='kw'>elsif</span> <span class='op'>!</span> <span class='const'>Numeric</span> <span class='op'>===</span> <span class='id identifier rubyid_rcond'>rcond</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>rcond must be Numeric</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_cond'>cond</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_s'>s</span> <span class='op'>&gt;</span> <span class='id identifier rubyid_rcond'>rcond</span> <span class='op'>*</span> <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_max'>max</span><span class='lparen'>(</span><span class='label'>axis:</span><span class='op'>-</span><span class='int'>1</span><span class='comma'>,</span> <span class='label'>keepdims:</span><span class='kw'>true</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_cond'>cond</span><span class='period'>.</span><span class='id identifier rubyid_all?'>all?</span>
      <span class='id identifier rubyid_r'>r</span> <span class='op'>=</span> <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_reciprocal'>reciprocal</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_r'>r</span> <span class='op'>=</span> <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_new_zeros'>new_zeros</span>
      <span class='id identifier rubyid_r'>r</span><span class='lbracket'>[</span><span class='id identifier rubyid_cond'>cond</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_s'>s</span><span class='lbracket'>[</span><span class='id identifier rubyid_cond'>cond</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_reciprocal'>reciprocal</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_u'>u</span> <span class='op'>*=</span> <span class='id identifier rubyid_r'>r</span><span class='lbracket'>[</span><span class='kw'>false</span><span class='comma'>,</span><span class='symbol'>:new</span><span class='comma'>,</span><span class='kw'>true</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_dot'>dot</span><span class='lparen'>(</span><span class='id identifier rubyid_u'>u</span><span class='comma'>,</span><span class='id identifier rubyid_vh'>vh</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_conj'>conj</span><span class='period'>.</span><span class='id identifier rubyid_swapaxes'>swapaxes</span><span class='lparen'>(</span><span class='op'>-</span><span class='int'>2</span><span class='comma'>,</span><span class='op'>-</span><span class='int'>1</span><span class='rparen'>)</span>
  <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^(ge)?ls[dsy]$</span><span class='regexp_end'>/</span></span>
    <span class='id identifier rubyid_b'>b</span> <span class='op'>=</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_eye'>eye</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='lbracket'>[</span><span class='op'>-</span><span class='int'>2</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_lstsq'>lstsq</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='comma'>,</span> <span class='label'>driver:</span><span class='id identifier rubyid_driver'>driver</span><span class='comma'>,</span> <span class='label'>rcond:</span><span class='id identifier rubyid_rcond'>rcond</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_x'>x</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_driver'>driver</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> is not one of drivers: </span><span class='tstring_end'>&quot;</span></span><span class='op'>+</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>svd, sdd, lsd, lss, lsy</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="qr-class_method">
  
    .<strong>qr</strong>(a, mode: &quot;reduce&quot;)  &#x21d2; <tt>r</tt>, ... 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Computes a QR factorization of a complex M-by-N matrix A: A = Q * R.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>a</span>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>m-by-n matrix A (&gt;= 2-dimensinal NArray)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>mode</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><ul>
  <li>“reduce”   – returns both Q and R,</li>
  <li>“r”        – returns only R,</li>
  <li>“economic” – returns both Q and R but computed in economy-size,</li>
  <li>“raw”      – returns QR and TAU used in LAPACK.</li>
</ul>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>r</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>if mode:”r”</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt>[q,r]</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>if mode:”reduce” or “economic”</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt>[<span class='object_link'><a href="#qr-class_method" title="Numo::Linalg.qr (method)">qr</a></span>,tau]</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>if mode:”raw” (LAPACK geqrf result)</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/numo/linalg/function.rb', line 206</span>

<span class='kw'>def</span> <span class='id identifier rubyid_qr'>qr</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='label'>mode:</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>reduce</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_qr'>qr</span><span class='comma'>,</span><span class='id identifier rubyid_tau'>tau</span><span class='comma'>,</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Linalg/Lapack.html" title="Numo::Linalg::Lapack (module)">Lapack</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Lapack.html#call-class_method" title="Numo::Linalg::Lapack.call (method)">call</a></span></span><span class='lparen'>(</span><span class='symbol'>:geqrf</span><span class='comma'>,</span> <span class='id identifier rubyid_a'>a</span><span class='rparen'>)</span>
  <span class='op'>*</span><span class='id identifier rubyid_shp'>shp</span><span class='comma'>,</span><span class='id identifier rubyid_m'>m</span><span class='comma'>,</span><span class='id identifier rubyid_n'>n</span> <span class='op'>=</span> <span class='id identifier rubyid_qr'>qr</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span>
  <span class='id identifier rubyid_r'>r</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_m'>m</span> <span class='op'>&gt;=</span> <span class='id identifier rubyid_n'>n</span> <span class='op'>&amp;&amp;</span> <span class='qwords_beg'>%w[</span><span class='tstring_content'>economic</span><span class='words_sep'> </span><span class='tstring_content'>raw</span><span class='tstring_end'>]</span></span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_mode'>mode</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='op'>?</span>
    <span class='id identifier rubyid_qr'>qr</span><span class='lbracket'>[</span><span class='kw'>false</span><span class='comma'>,</span> <span class='int'>0</span><span class='op'>...</span><span class='id identifier rubyid_n'>n</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_triu'>triu</span> <span class='op'>:</span> <span class='id identifier rubyid_qr'>qr</span><span class='period'>.</span><span class='id identifier rubyid_triu'>triu</span>
  <span class='id identifier rubyid_mode'>mode</span> <span class='op'>=</span> <span class='id identifier rubyid_mode'>mode</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_mode'>mode</span>
  <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>r</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>return</span> <span class='id identifier rubyid_r'>r</span>
  <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>raw</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>return</span> <span class='lbracket'>[</span><span class='id identifier rubyid_qr'>qr</span><span class='comma'>,</span><span class='id identifier rubyid_tau'>tau</span><span class='rbracket'>]</span>
  <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>reduce</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>economic</span><span class='tstring_end'>&quot;</span></span>
    <span class='comment'># skip
</span>  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>invalid mode:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_mode'>mode</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_m'>m</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_n'>n</span>
    <span class='id identifier rubyid_q'>q</span><span class='comma'>,</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Linalg/Lapack.html" title="Numo::Linalg::Lapack (module)">Lapack</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Lapack.html#call-class_method" title="Numo::Linalg::Lapack.call (method)">call</a></span></span><span class='lparen'>(</span><span class='symbol'>:orgqr</span><span class='comma'>,</span> <span class='id identifier rubyid_qr'>qr</span><span class='lbracket'>[</span><span class='kw'>false</span><span class='comma'>,</span> <span class='int'>0</span><span class='op'>...</span><span class='id identifier rubyid_m'>m</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_tau'>tau</span><span class='rparen'>)</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_mode'>mode</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>economic</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_q'>q</span><span class='comma'>,</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Linalg/Lapack.html" title="Numo::Linalg::Lapack (module)">Lapack</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Lapack.html#call-class_method" title="Numo::Linalg::Lapack.call (method)">call</a></span></span><span class='lparen'>(</span><span class='symbol'>:orgqr</span><span class='comma'>,</span> <span class='id identifier rubyid_qr'>qr</span><span class='comma'>,</span> <span class='id identifier rubyid_tau'>tau</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_qqr'>qqr</span> <span class='op'>=</span> <span class='id identifier rubyid_qr'>qr</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_zeros'>zeros</span><span class='lparen'>(</span><span class='op'>*</span><span class='lparen'>(</span><span class='id identifier rubyid_shp'>shp</span><span class='op'>+</span><span class='lbracket'>[</span><span class='id identifier rubyid_m'>m</span><span class='comma'>,</span><span class='id identifier rubyid_m'>m</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_qqr'>qqr</span><span class='lbracket'>[</span><span class='kw'>false</span><span class='comma'>,</span><span class='int'>0</span><span class='op'>...</span><span class='id identifier rubyid_n'>n</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_qr'>qr</span>
    <span class='id identifier rubyid_q'>q</span><span class='comma'>,</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Linalg/Lapack.html" title="Numo::Linalg::Lapack (module)">Lapack</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Lapack.html#call-class_method" title="Numo::Linalg::Lapack.call (method)">call</a></span></span><span class='lparen'>(</span><span class='symbol'>:orgqr</span><span class='comma'>,</span> <span class='id identifier rubyid_qqr'>qqr</span><span class='comma'>,</span> <span class='id identifier rubyid_tau'>tau</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='lbracket'>[</span><span class='id identifier rubyid_q'>q</span><span class='comma'>,</span><span class='id identifier rubyid_r'>r</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="slogdet-class_method">
  
    .<strong>slogdet</strong>(a)  &#x21d2; <tt>[sign,logdet]</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Natural logarithm of the determinant of a matrix</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>a</span>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>matrix (&gt;= 2-dimensional NArray)</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>[sign,logdet]</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><ul>
  <li><strong>sign</strong> – A number representing the sign of the determinant.</li>
  <li><strong>logdet</strong> – The natural log of the absolute value of the determinant.</li>
</ul>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


831
832
833
834
835
836
837
838
839
840
841
842
843
844</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/numo/linalg/function.rb', line 831</span>

<span class='kw'>def</span> <span class='id identifier rubyid_slogdet'>slogdet</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_lu'>lu</span><span class='comma'>,</span> <span class='id identifier rubyid_piv'>piv</span><span class='comma'>,</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Linalg/Lapack.html" title="Numo::Linalg::Lapack (module)">Lapack</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Lapack.html#call-class_method" title="Numo::Linalg::Lapack.call (method)">call</a></span></span><span class='lparen'>(</span><span class='symbol'>:getrf</span><span class='comma'>,</span> <span class='id identifier rubyid_a'>a</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_idx'>idx</span> <span class='op'>=</span> <span class='id identifier rubyid_piv'>piv</span><span class='period'>.</span><span class='id identifier rubyid_new_narray'>new_narray</span><span class='period'>.</span><span class='id identifier rubyid_store'>store</span><span class='lparen'>(</span><span class='id identifier rubyid_piv'>piv</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_piv'>piv</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='lbracket'>[</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_seq'>seq</span><span class='lparen'>(</span><span class='int'>1</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_m'>m</span> <span class='op'>=</span> <span class='id identifier rubyid_piv'>piv</span><span class='period'>.</span><span class='id identifier rubyid_eq'>eq</span><span class='lparen'>(</span><span class='id identifier rubyid_idx'>idx</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_count_false'>count_false</span><span class='lparen'>(</span><span class='label'>axis:</span><span class='op'>-</span><span class='int'>1</span><span class='rparen'>)</span> <span class='op'>%</span> <span class='int'>2</span>
  <span class='id identifier rubyid_sign'>sign</span> <span class='op'>=</span> <span class='id identifier rubyid_m'>m</span> <span class='op'>*</span> <span class='op'>-</span><span class='int'>2</span> <span class='op'>+</span> <span class='int'>1</span>

  <span class='id identifier rubyid_lud'>lud</span> <span class='op'>=</span> <span class='id identifier rubyid_lu'>lu</span><span class='period'>.</span><span class='id identifier rubyid_diagonal'>diagonal</span>
  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_lud'>lud</span><span class='period'>.</span><span class='id identifier rubyid_eq'>eq</span> <span class='int'>0</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span>
    <span class='kw'>return</span> <span class='int'>0</span><span class='comma'>,</span> <span class='lparen'>(</span><span class='op'>-</span><span class='const'>Float</span><span class='op'>::</span><span class='const'>INFINITY</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_lud_abs'>lud_abs</span> <span class='op'>=</span> <span class='id identifier rubyid_lud'>lud</span><span class='period'>.</span><span class='id identifier rubyid_abs'>abs</span>
  <span class='id identifier rubyid_sign'>sign</span> <span class='op'>*=</span> <span class='lparen'>(</span><span class='id identifier rubyid_lud'>lud</span><span class='op'>/</span><span class='id identifier rubyid_lud_abs'>lud_abs</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_prod'>prod</span>
  <span class='lbracket'>[</span><span class='id identifier rubyid_sign'>sign</span><span class='comma'>,</span> <span class='const'>NMath</span><span class='period'>.</span><span class='id identifier rubyid_log'>log</span><span class='lparen'>(</span><span class='id identifier rubyid_lud_abs'>lud_abs</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_sum'>sum</span><span class='lparen'>(</span><span class='label'>axis:</span><span class='op'>-</span><span class='int'>1</span><span class='rparen'>)</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="solve-class_method">
  
    .<strong>solve</strong>(a, b, driver: &quot;gen&quot;, uplo: &#39;U&#39;)  &#x21d2; <tt>Numo::NArray</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Solves linear equation <code>a * x = b</code> for <code>x</code>
from square matrix <code>a</code></p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>a</span>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>n-by-n square matrix  (&gt;= 2-dimensinal NArray)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>b</span>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>n-by-nrhs right-hand-side matrix (&gt;=
1-dimensinal NArray)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>driver</span>
      
      
        <span class='type'>(<tt>String or Symbol</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>choose LAPACK diriver from
‘gen’,’sym’,’her’ or ‘pos’. (optional, default=’gen’)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>uplo</span>
      
      
        <span class='type'>(<tt>String or Symbol</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>optional, default=’U’. Access upper
or (‘U’) lower (‘L’) triangle. (omitted when driver:”gen”)</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The solusion matrix/vector X.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


889
890
891
892
893
894
895
896
897
898
899
900</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/numo/linalg/function.rb', line 889</span>

<span class='kw'>def</span> <span class='id identifier rubyid_solve'>solve</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='comma'>,</span> <span class='label'>driver:</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>gen</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>uplo:</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>U</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_driver'>driver</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
  <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^gen?(sv)?$</span><span class='regexp_end'>/i</span></span>
    <span class='comment'># returns lu, x, ipiv, info
</span>    <span class='const'><span class='object_link'><a href="Linalg/Lapack.html" title="Numo::Linalg::Lapack (module)">Lapack</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Lapack.html#call-class_method" title="Numo::Linalg::Lapack.call (method)">call</a></span></span><span class='lparen'>(</span><span class='symbol'>:gesv</span><span class='comma'>,</span> <span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span>
  <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^(sym?|her?|pos?)(sv)?$</span><span class='regexp_end'>/i</span></span>
    <span class='id identifier rubyid_func'>func</span> <span class='op'>=</span> <span class='id identifier rubyid_driver'>driver</span><span class='lbracket'>[</span><span class='int'>0</span><span class='op'>..</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span><span class='op'>+</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>sv</span><span class='tstring_end'>&quot;</span></span>
    <span class='const'><span class='object_link'><a href="Linalg/Lapack.html" title="Numo::Linalg::Lapack (module)">Lapack</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Lapack.html#call-class_method" title="Numo::Linalg::Lapack.call (method)">call</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_func'>func</span><span class='comma'>,</span> <span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='comma'>,</span> <span class='label'>uplo:</span><span class='id identifier rubyid_uplo'>uplo</span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>invalid driver: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_driver'>driver</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="svd-class_method">
  
    .<strong>svd</strong>(a, driver: &#39;svd&#39;, job: &#39;A&#39;)  &#x21d2; <tt>[sigma,u,vt]</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Computes the Singular Value Decomposition (SVD) of a M-by-N matrix A,
and the left and/or right singular vectors.  The SVD is written</p>

<pre class="code ruby"><code class="ruby"><span class='const'>A</span> <span class='op'>=</span> <span class='const'>U</span> <span class='op'>*</span> <span class='const'>SIGMA</span> <span class='op'>*</span> <span class='id identifier rubyid_transpose'>transpose</span><span class='lparen'>(</span><span class='const'>V</span><span class='rparen'>)</span>
</code></pre>

<p>where SIGMA is an M-by-N matrix which is zero except for its
min(m,n) diagonal elements, U is an M-by-M orthogonal matrix, and
V is an N-by-N orthogonal matrix. The diagonal elements of SIGMA
are the singular values of A; they are real and non-negative, and
are returned in descending order. The first min(m,n) columns of U
and V are the left and right singular vectors of A. Note that the
routine returns V**T, not V.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>a</span>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>m-by-n matrix A (&gt;= 2-dimensinal NArray)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>driver</span>
      
      
        <span class='type'>(<tt>String or Symbol</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>choose LAPACK solver from ‘svd’,
‘sdd’. (optional, default=’svd’)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>job</span>
      
      
        <span class='type'>(<tt>String or Symbol</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><ul>
  <li>‘A’: all M columns of U and all N rows of V**T are returned in
the arrays U and VT.</li>
  <li>‘S’: the first min(M,N) columns of U and the first min(M,N)
rows of V**T are returned in the arrays U and VT.</li>
  <li>‘N’:  no columns of U or rows of V**T are computed.</li>
</ul>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>[sigma,u,vt]</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>SVD result. Array<Numo::NArray></Numo::NArray></p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


259
260
261
262
263
264
265
266
267
268
269
270
271</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/numo/linalg/function.rb', line 259</span>

<span class='kw'>def</span> <span class='id identifier rubyid_svd'>svd</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='label'>driver:</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>svd</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>job:</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>A</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='kw'>unless</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^[ASN]</span><span class='regexp_end'>/i</span></span> <span class='op'>=~</span> <span class='id identifier rubyid_job'>job</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>invalid job: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_job'>job</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_driver'>driver</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
  <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^(ge)?sdd$</span><span class='regexp_end'>/i</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>turbo</span><span class='tstring_end'>&quot;</span></span>
    <span class='const'><span class='object_link'><a href="Linalg/Lapack.html" title="Numo::Linalg::Lapack (module)">Lapack</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Lapack.html#call-class_method" title="Numo::Linalg::Lapack.call (method)">call</a></span></span><span class='lparen'>(</span><span class='symbol'>:gesdd</span><span class='comma'>,</span> <span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='label'>jobz:</span><span class='id identifier rubyid_job'>job</span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='op'>..</span><span class='int'>2</span><span class='rbracket'>]</span>
  <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^(ge)?svd$</span><span class='regexp_end'>/i</span></span>
    <span class='const'><span class='object_link'><a href="Linalg/Lapack.html" title="Numo::Linalg::Lapack (module)">Lapack</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Lapack.html#call-class_method" title="Numo::Linalg::Lapack.call (method)">call</a></span></span><span class='lparen'>(</span><span class='symbol'>:gesvd</span><span class='comma'>,</span> <span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='label'>jobu:</span><span class='id identifier rubyid_job'>job</span><span class='comma'>,</span> <span class='label'>jobvt:</span><span class='id identifier rubyid_job'>job</span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='op'>..</span><span class='int'>2</span><span class='rbracket'>]</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>invalid driver: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_driver'>driver</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="svdvals-class_method">
  
    .<strong>svdvals</strong>(a, driver: &#39;svd&#39;)  &#x21d2; <tt>Numo::NArray</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Computes the Singular Values of a M-by-N matrix A.
The SVD is written</p>

<pre class="code ruby"><code class="ruby"><span class='const'>A</span> <span class='op'>=</span> <span class='const'>U</span> <span class='op'>*</span> <span class='const'>SIGMA</span> <span class='op'>*</span> <span class='id identifier rubyid_transpose'>transpose</span><span class='lparen'>(</span><span class='const'>V</span><span class='rparen'>)</span>
</code></pre>

<p>where SIGMA is an M-by-N matrix which is zero except for its
min(m,n) diagonal elements. The diagonal elements of SIGMA
are the singular values of A; they are real and non-negative, and
are returned in descending order.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>a</span>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>m-by-n matrix A (&gt;= 2-dimensinal NArray)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>driver</span>
      
      
        <span class='type'>(<tt>String or Symbol</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>choose LAPACK solver from ‘svd’,
‘sdd’. (optional, default=’svd’)</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Numo::NArray</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>returns SIGMA (singular values).</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


288
289
290
291
292
293
294
295
296
297</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/numo/linalg/function.rb', line 288</span>

<span class='kw'>def</span> <span class='id identifier rubyid_svdvals'>svdvals</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='label'>driver:</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>svd</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_driver'>driver</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
  <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^(ge)?sdd$</span><span class='regexp_end'>/i</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>turbo</span><span class='tstring_end'>&quot;</span></span>
    <span class='const'><span class='object_link'><a href="Linalg/Lapack.html" title="Numo::Linalg::Lapack (module)">Lapack</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Lapack.html#call-class_method" title="Numo::Linalg::Lapack.call (method)">call</a></span></span><span class='lparen'>(</span><span class='symbol'>:gesdd</span><span class='comma'>,</span> <span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='label'>jobz:</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>N</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
  <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^(ge)?svd$</span><span class='regexp_end'>/i</span></span>
    <span class='const'><span class='object_link'><a href="Linalg/Lapack.html" title="Numo::Linalg::Lapack (module)">Lapack</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'><span class='object_link'><a href="Linalg/Lapack.html#call-class_method" title="Numo::Linalg::Lapack.call (method)">call</a></span></span><span class='lparen'>(</span><span class='symbol'>:gesvd</span><span class='comma'>,</span> <span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='label'>jobu:</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>N</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>jobvt:</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>N</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>invalid driver: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_driver'>driver</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Thu Aug 23 15:25:34 2018 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.12 (ruby-2.5.0).
</div>

    </div>
  </body>
</html>